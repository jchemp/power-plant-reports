Private Sub TextBox1_KeyDown(KeyCode As Integer, Shift As Integer)

' This function is just to allow user to hit the Enter key to submit their Ensuite Credentials

    If KeyCode = 13 Then
         cmdOK_Click
    End If
End Sub


Private Sub UserForm_Initialize()
  
' Getting dropdown list in form to populate with month selections

    Dim DateName As Variant
    DateName = VBA.Array(Format(Date, "mmmm-yyyy"), Format(DateAdd("m", -1, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -2, Date), "mmmm-yyyy"), Format(DateAdd("m", -3, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -4, Date), "mmmm-yyyy"), Format(DateAdd("m", -5, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -6, Date), "mmmm-yyyy"), Format(DateAdd("m", -7, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -8, Date), "mmmm-yyyy"), Format(DateAdd("m", -9, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -10, Date), "mmmm-yyyy"), Format(DateAdd("m", -11, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -12, Date), "mmmm-yyyy"), Format(DateAdd("m", -13, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -14, Date), "mmmm-yyyy"), Format(DateAdd("m", -15, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -16, Date), "mmmm-yyyy"), Format(DateAdd("m", -17, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -18, Date), "mmmm-yyyy"), Format(DateAdd("m", -19, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -20, Date), "mmmm-yyyy"), Format(DateAdd("m", -21, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -22, Date), "mmmm-yyyy"), Format(DateAdd("m", -23, Date), "mmmm-yyyy") _
    , Format(DateAdd("m", -24, Date), "mmmm-yyyy"))

    With input_StartDate
           .Clear
           .List = DateName
           .ListIndex = -1
    End With

    With input_EndDate
           .Clear
           .List = DateName
           .ListIndex = -1
    End With

End Sub

Private Sub cmdOK_Click()

Dim relativePath As String

'Set Object to Connect to Database'
Set objSession = CreateObject("OracleinProcServer.XOraSession")
Set objdatabase = objSession.OpenDatabase("ENSUIT1P", input_UserID & "/" & input_Password, 0)
                
' Close the UserForm.
Unload Me

'Screen updating Off
Application.ScreenUpdating = False
Application.DisplayAlerts = False

'Begin Motoring Data pull'
'Clear Previous Data
Sheets("Motoring Data").Select
With Sheets("Motoring Data")
    .Rows(103 & ":" & .Rows.Count).Delete
End With

'Enter SQL Statement'
strSQL = " WITH DATE_DETAILS AS ( "
strSQL = strSQL & " SELECT trade_Date "
strSQL = strSQL & " , BA_ID "
strSQL = strSQL & " , max(messageheaderid) messageheaderid  "
strSQL = strSQL & " , CASE WHEN run_description LIKE 'MONTHLY%' THEN 'Monthly' ELSE 'Daily' END AS Freq "
strSQL = strSQL & " FROM messageheader "
strSQL = strSQL & " WHERE trade_date BETWEEN '" & Format(DateSerial(Year(input_StartDate), Month(input_StartDate), 1), "dd-mmm-yyyy") & "' AND '" & Format(DateSerial(Year(input_EndDate), Month(input_EndDate) + 1, 1) - 1, "dd-mmm-yyyy") & "' "
strSQL = strSQL & " AND file_type = 'DETERMINANTS' "
strSQL = strSQL & " GROUP BY trade_Date, BA_ID, CASE WHEN run_description LIKE 'MONTHLY%' THEN 'Monthly' ELSE 'Daily' END) "
strSQL = strSQL & " SELECT CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " ELSE 'ERROR' END AS AREA "
strSQL = strSQL & " , CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN 'Hat Creek 1' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN 'Hat Creek 2' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN 'Pit 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN 'Pit 1 U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN 'Pit 3 U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN 'Pit 4 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN 'Pit 5 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN 'Pit 5 U3 and U4' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN 'James B Black U1' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN 'James B Black U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN 'Pit 6 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN 'Pit 6 U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN 'Pit 7 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN 'Pit 7 U2' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN 'Coleman' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN 'Cow Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN 'Inskip' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN 'Kilarc U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN 'South' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN 'Volta 1' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN 'Volta 2' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN 'Hamilton Branch U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN 'Butt Valley' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN 'Caribou 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN 'Caribou 1 U2 and U3' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN 'Caribou 2 U4 and U5' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN 'Oak Flat' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN 'Belden' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN 'Rock Creek U1' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN 'Rock Creek U2' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN 'Bucks Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN 'Cresta U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN 'Poe U1' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN 'Poe U2' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN 'Potter Valley U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN 'Toadtown' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN 'DeSabla' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN 'Centerville U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN 'Lime Saddle U1 andU2' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN 'Narrows' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN 'Spaulding 1 and 2' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN 'Spaulding 3' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN 'Deer Creek' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN 'Drum 1 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN 'Drum 1 U3 and U4' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN 'Drum 2 U5' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN 'Alta Powerhouse' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN 'Dutch Flat 1' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN 'Halsey' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN 'Wise 1' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN 'Wise 2' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN 'Newcastle' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN 'Chili Bar' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN 'Salt Springs 1 and 2' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN 'Tiger Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN 'West Point' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN 'Electra U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN 'Spring Gap' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN 'Stanislaus' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN 'Phoenix' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN 'Merced Falls' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN 'Haas U1, Haas U2' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN 'Balch 1' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN 'Balch 2 U2' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN 'Balch 2 U3' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN 'Kings River' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN 'Crane Valley' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN 'San Joaquin 1A, AG Wishon U1-U4' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN 'San Joaquin 2' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN 'San Joaquin 3' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN 'Kerckhoff 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN 'Kerckhoff 1 U3' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN 'Kerckhoff 2' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN 'Tule River U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN 'Kern Canyon' "

strSQL = strSQL & " ELSE 'ERROR' END AS RESOURCE_NAME "
strSQL = strSQL & " , CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN '1' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN '2' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN '3' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN '4' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN '5' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN '6' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN '7' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN '8' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN '9' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN '10' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN '11' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN '12' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN '13' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN '14' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN '15' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN '16' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN '17' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN '18' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN '19' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN '20' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN '21' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN '22' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN '23' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN '24' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN '25' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN '26' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN '27' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN '28' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN '29' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN '30' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN '31' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN '32' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN '33' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN '34' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN '35' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN '36' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN '37' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN '38' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN '39' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN '40' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN '41' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN '42' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN '43' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN '44' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN '45' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN '46' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN '47' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN '48' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN '49' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN '50' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN '51' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN '52' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN '53' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN '54' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN '55' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN '56' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN '57' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN '58' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN '59' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN '60' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN '61' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN '62' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN '63' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN '64' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN '65' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN '66' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN '67' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN '68' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN '69' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN '70' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN '71' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN '72' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN '73' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN '74' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN '75' "
strSQL = strSQL & " ELSE 'ERROR' END AS PRIORITY "
strSQL = strSQL & " , RESOURCE_TYPE "
strSQL = strSQL & " , round(sum(CASE WHEN DA_QTY = '0' AND FMM_QTY = '0' AND RTD_QTY = '0' AND UIE_QTY < '0' THEN UIE_QTY ELSE 0 END),4) AS QTY_MOTOR "
strSQL = strSQL & " , -1*round(sum(CASE WHEN DA_QTY = '0' AND FMM_QTY = '0' AND RTD_QTY = '0' AND UIE_QTY < '0' THEN UIE_AMT ELSE 0 END),4) AS AMT_MOTOR "
strSQL = strSQL & " , round(sum(CASE WHEN DA_QTY = '0' THEN CASE WHEN FMM_QTY != '0' or RTD_QTY != '0' THEN FMM_QTY+RTD_QTY+UIE_QTY ELSE 0 END END),4) AS QTY_MOTOR_TO_DSP "
strSQL = strSQL & " , -1*round(sum(case WHEN DA_QTY = '0' THEN CASE WHEN FMM_QTY != '0' or RTD_QTY != '0' THEN FMM_AMT+RTD_AMT+UIE_AMT ELSE 0 END END),4) AS AMT_MOTOR_TO_DSP  "
strSQL = strSQL & " FROM "
strSQL = strSQL & " (SELECT attributevalue1 AS SCID "
strSQL = strSQL & " , TRADE_DATE "
strSQL = strSQL & " , attributevalue2 AS RESOURCE_NAME "
strSQL = strSQL & " , attributevalue3 AS Resource_type "
strSQL = strSQL & " , HOUR "
strSQL = strSQL & " , INTERVAL "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_HRLY_RSRC_DA_ENGY_SCHD@QUANTITY' THEN VAL ELSE 0 END) AS DA_QTY "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_FMM_IIE_STLMT_RTPG@QUANTITY' THEN VAL ELSE 0 END) AS FMM_QTY "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_IIE@QUANTITY' THEN VAL ELSE 0 END) AS  RTD_QTY "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_TOT_UIE@QUANTITY' THEN VAL ELSE 0 END) AS UIE_QTY "
strSQL = strSQL & " , SUM(CASE WHEN NAME IN ('RSRC_HRLY_DA_ENGY_LMP_NON_CONTRACT@AMOUNT', 'BA_HRLY_DA_ENGY_CONTRACT@AMOUNT') THEN VAL ELSE 0 END) AS DA_AMT "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_FMM_IIE_STLMT@AMOUNT' THEN VAL ELSE 0 END) AS  FMM_AMT "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_IIE@AMOUNT' THEN VAL ELSE 0 END) AS  RTD_AMT "
strSQL = strSQL & " , SUM(CASE WHEN NAME = 'BA_5M_RSRC_UIE@AMOUNT' THEN VAL ELSE 0 END) AS  UIE_AMT "
strSQL = strSQL & " FROM ((SELECT bt.name "
strSQL = strSQL & " , bt.trade_date "
strSQL = strSQL & " , bt.attributevalue1  "
strSQL = strSQL & " , bt.attributevalue2  "
strSQL = strSQL & " , bt.attributevalue3  "
strSQL = strSQL & " , t.hour "
strSQL = strSQL & " , t.interval "
strSQL = strSQL & " , CASE INTERVAL  "
strSQL = strSQL & " WHEN 1 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 2 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 3 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 4 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 5 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 6 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 7 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 8 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 9 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 10 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 11 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 12 THEN TO_NUMBER(NVL(INT001,0)/12)  "
strSQL = strSQL & " WHEN 13 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 14 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 15 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 16 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 17 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 18 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 19 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 20 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 21 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 22 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 23 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 24 THEN TO_NUMBER(NVL(INT002,0)/12)  "
strSQL = strSQL & " WHEN 25 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 26 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 27 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 28 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 29 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 30 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 31 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 32 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 33 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 34 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 35 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 36 THEN TO_NUMBER(NVL(INT003,0)/12)  "
strSQL = strSQL & " WHEN 37 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 38 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 39 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 40 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 41 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 42 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 43 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 44 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 45 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 46 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 47 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 48 THEN TO_NUMBER(NVL(INT004,0)/12)  "
strSQL = strSQL & " WHEN 49 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 50 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 51 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 52 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 53 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 54 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 55 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 56 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 57 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 58 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 59 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 60 THEN TO_NUMBER(NVL(INT005,0)/12)  "
strSQL = strSQL & " WHEN 61 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 62 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 63 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 64 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 65 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 66 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 67 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 68 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 69 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 70 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 71 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 72 THEN TO_NUMBER(NVL(INT006,0)/12)  "
strSQL = strSQL & " WHEN 73 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 74 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 75 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 76 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 77 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 78 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 79 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 80 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 81 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 82 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 83 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 84 THEN TO_NUMBER(NVL(INT007,0)/12)  "
strSQL = strSQL & " WHEN 85 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 86 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 87 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 88 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 89 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 90 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 91 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 92 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 93 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 94 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 95 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 96 THEN TO_NUMBER(NVL(INT008,0)/12)  "
strSQL = strSQL & " WHEN 97 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 98 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 99 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 100 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 101 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 102 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 103 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 104 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 105 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 106 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 107 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 108 THEN TO_NUMBER(NVL(INT009,0)/12)  "
strSQL = strSQL & " WHEN 109 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 110 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 111 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 112 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 113 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 114 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 115 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 116 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 117 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 118 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 119 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 120 THEN TO_NUMBER(NVL(INT010,0)/12)  "
strSQL = strSQL & " WHEN 121 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 122 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 123 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 124 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 125 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 126 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 127 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 128 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 129 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 130 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 131 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 132 THEN TO_NUMBER(NVL(INT011,0)/12)  "
strSQL = strSQL & " WHEN 133 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 134 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 135 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 136 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 137 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 138 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 139 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 140 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 141 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 142 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 143 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 144 THEN TO_NUMBER(NVL(INT012,0)/12)  "
strSQL = strSQL & " WHEN 145 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 146 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 147 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 148 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 149 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 150 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 151 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 152 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 153 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 154 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 155 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 156 THEN TO_NUMBER(NVL(INT013,0)/12)  "
strSQL = strSQL & " WHEN 157 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 158 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 159 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 160 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 161 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 162 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 163 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 164 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 165 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 166 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 167 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 168 THEN TO_NUMBER(NVL(INT014,0)/12)  "
strSQL = strSQL & " WHEN 169 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 170 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 171 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 172 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 173 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 174 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 175 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 176 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 177 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 178 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 179 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 180 THEN TO_NUMBER(NVL(INT015,0)/12)  "
strSQL = strSQL & " WHEN 181 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 182 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 183 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 184 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 185 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 186 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 187 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 188 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 189 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 190 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 191 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 192 THEN TO_NUMBER(NVL(INT016,0)/12)  "
strSQL = strSQL & " WHEN 193 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 194 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 195 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 196 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 197 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 198 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 199 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 200 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 201 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 202 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 203 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 204 THEN TO_NUMBER(NVL(INT017,0)/12)  "
strSQL = strSQL & " WHEN 205 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 206 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 207 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 208 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 209 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 210 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 211 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 212 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 213 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 214 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 215 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 216 THEN TO_NUMBER(NVL(INT018,0)/12)  "
strSQL = strSQL & " WHEN 217 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 218 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 219 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 220 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 221 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 222 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 223 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 224 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 225 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 226 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 227 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 228 THEN TO_NUMBER(NVL(INT019,0)/12)  "
strSQL = strSQL & " WHEN 229 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 230 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 231 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 232 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 233 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 234 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 235 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 236 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 237 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 238 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 239 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 240 THEN TO_NUMBER(NVL(INT020,0)/12)  "
strSQL = strSQL & " WHEN 241 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 242 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 243 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 244 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 245 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 246 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 247 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 248 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 249 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 250 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 251 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 252 THEN TO_NUMBER(NVL(INT021,0)/12)  "
strSQL = strSQL & " WHEN 253 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 254 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 255 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 256 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 257 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 258 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 259 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 260 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 261 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 262 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 263 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 264 THEN TO_NUMBER(NVL(INT022,0)/12)  "
strSQL = strSQL & " WHEN 265 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 266 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 267 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 268 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 269 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 270 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 271 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 272 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 273 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 274 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 275 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 276 THEN TO_NUMBER(NVL(INT023,0)/12)  "
strSQL = strSQL & " WHEN 277 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 278 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 279 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 280 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 281 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 282 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 283 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 284 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 285 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 286 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 287 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 288 THEN TO_NUMBER(NVL(INT024,0)/12)  "
strSQL = strSQL & " WHEN 289 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 290 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 291 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 292 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 293 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 294 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 295 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 296 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 297 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 298 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 299 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " WHEN 300 THEN TO_NUMBER(NVL(INT025,0)/12)  "
strSQL = strSQL & " ELSE 0 END AS VAL  "
strSQL = strSQL & " FROM "
strSQL = strSQL & " (SELECT a.name "
strSQL = strSQL & " , a.trade_date "
strSQL = strSQL & " , CASE WHEN a.intervalcount = '25' THEN '300' ELSE A.INTERVALCOUNT END AS INTERVALCOUNT "
strSQL = strSQL & " , a.attributevalue1  "
strSQL = strSQL & " , a.attributevalue2  "
strSQL = strSQL & " , a.attributevalue3  "
strSQL = strSQL & " , a.int001, a.int002, a.int003, a.int004, a.int005,  "
strSQL = strSQL & " a.int006, a.int007, a.int008, a.int009, a.int010,  "
strSQL = strSQL & " a.int011, a.int012, a.int013, a.int014, a.int015,  "
strSQL = strSQL & " a.int016, a.int017, a.int018, a.int019, a.int020,  "
strSQL = strSQL & " a.int021, a.int022, a.int023, a.int024, a.int025,  "
strSQL = strSQL & " a.int026, a.int027, a.int028, a.int029, a.int030,  "
strSQL = strSQL & " a.int031, a.int032, a.int033, a.int034, a.int035,  "
strSQL = strSQL & " a.int036, a.int037, a.int038, a.int039, a.int040,  "
strSQL = strSQL & " a.int041, a.int042, a.int043, a.int044, a.int045,  "
strSQL = strSQL & " a.int046, a.int047, a.int048, a.int049, a.int050,  "
strSQL = strSQL & " a.int051, a.int052, a.int053, a.int054, a.int055,  "
strSQL = strSQL & " a.int056, a.int057, a.int058, a.int059, a.int060,  "
strSQL = strSQL & " a.int061, a.int062, a.int063, a.int064, a.int065,  "
strSQL = strSQL & " a.int066, a.int067, a.int068, a.int069, a.int070,  "
strSQL = strSQL & " a.int071, a.int072, a.int073, a.int074, a.int075,  "
strSQL = strSQL & " a.int076, a.int077, a.int078, a.int079, a.int080,  "
strSQL = strSQL & " a.int081, a.int082, a.int083, a.int084, a.int085,  "
strSQL = strSQL & " a.int086, a.int087, a.int088, a.int089, a.int090,  "
strSQL = strSQL & " a.int091, a.int092, a.int093, a.int094, a.int095,  "
strSQL = strSQL & " a.int096, a.int097, a.int098, a.int099, a.int100,  "
strSQL = strSQL & " a.int101, a.int102, a.int103, a.int104, a.int105,  "
strSQL = strSQL & " a.int106, a.int107, a.int108, a.int109, a.int110,  "
strSQL = strSQL & " a.int111, a.int112, a.int113, a.int114, a.int115,  "
strSQL = strSQL & " a.int116, a.int117, a.int118, a.int119, a.int120,  "
strSQL = strSQL & " a.int121, a.int122, a.int123, a.int124, a.int125,  "
strSQL = strSQL & " a.int126, a.int127, a.int128, a.int129, a.int130,  "
strSQL = strSQL & " a.int131, a.int132, a.int133, a.int134, a.int135,  "
strSQL = strSQL & " a.int136, a.int137, a.int138, a.int139, a.int140,  "
strSQL = strSQL & " a.int141, a.int142, a.int143, a.int144, a.int145,  "
strSQL = strSQL & " a.int146, a.int147, a.int148, a.int149, a.int150,  "
strSQL = strSQL & " a.int151, a.int152, a.int153, a.int154, a.int155,  "
strSQL = strSQL & " a.int156, a.int157, a.int158, a.int159, a.int160,  "
strSQL = strSQL & " a.int161, a.int162, a.int163, a.int164, a.int165,  "
strSQL = strSQL & " a.int166, a.int167, a.int168, a.int169, a.int170,  "
strSQL = strSQL & " a.int171, a.int172, a.int173, a.int174, a.int175,  "
strSQL = strSQL & " a.int176, a.int177, a.int178, a.int179, a.int180,  "
strSQL = strSQL & " a.int181, a.int182, a.int183, a.int184, a.int185,  "
strSQL = strSQL & " a.int186, a.int187, a.int188, a.int189, a.int190,  "
strSQL = strSQL & " a.int191, a.int192, a.int193, a.int194, a.int195,  "
strSQL = strSQL & " a.int196, a.int197, a.int198, a.int199, a.int200,  "
strSQL = strSQL & " a.int201, a.int202, a.int203, a.int204, a.int205,  "
strSQL = strSQL & " a.int206, a.int207, a.int208, a.int209, a.int210,  "
strSQL = strSQL & " a.int211, a.int212, a.int213, a.int214, a.int215,  "
strSQL = strSQL & " a.int216, a.int217, a.int218, a.int219, a.int220,  "
strSQL = strSQL & " a.int221, a.int222, a.int223, a.int224, a.int225,  "
strSQL = strSQL & " a.int226, a.int227, a.int228, a.int229, a.int230,  "
strSQL = strSQL & " a.int231, a.int232, a.int233, a.int234, a.int235,  "
strSQL = strSQL & " a.int236, a.int237, a.int238, a.int239, a.int240,  "
strSQL = strSQL & " a.int241, a.int242, a.int243, a.int244, a.int245,  "
strSQL = strSQL & " a.int246, a.int247, a.int248, a.int249, a.int250,  "
strSQL = strSQL & " a.int251, a.int252, a.int253, a.int254, a.int255,  "
strSQL = strSQL & " a.int256, a.int257, a.int258, a.int259, a.int260,  "
strSQL = strSQL & " a.int261, a.int262, a.int263, a.int264, a.int265,  "
strSQL = strSQL & " a.int266, a.int267, a.int268, a.int269, a.int270,  "
strSQL = strSQL & " a.int271, a.int272, a.int273, a.int274, a.int275,  "
strSQL = strSQL & " a.int276, a.int277, a.int278, a.int279, a.int280,  "
strSQL = strSQL & " a.int281, a.int282, a.int283, a.int284, a.int285,  "
strSQL = strSQL & " a.int286, a.int287, a.int288, a.int289, a.int290,  "
strSQL = strSQL & " a.int291, a.int292, a.int293, a.int294, a.int295,  "
strSQL = strSQL & " a.int296, a.int297, a.int298, a.int299, a.int300  "
strSQL = strSQL & " FROM billdeterminant a "
strSQL = strSQL & " WHERE a.name IN ('RSRC_HRLY_DA_ENGY_LMP_NON_CONTRACT@AMOUNT', 'BA_HRLY_DA_ENGY_CONTRACT@AMOUNT','BA_HRLY_RSRC_DA_ENGY_SCHD@QUANTITY')  "
strSQL = strSQL & " AND a.messageheaderid in (select MESSAGEHEADERID from date_details)    "
strSQL = strSQL & " AND a.attributevalue2 in ( 'HATCR1_7_UNIT', 'HATCR2_7_UNIT', 'PIT1_7_UNIT 1', 'PIT1_7_UNIT 2', 'PIT3_7_PL1X3', 'PIT4_7_PL1X2', 'PIT5_7_PL1X2' "
strSQL = strSQL & " , 'PIT5_7_PL3X4', 'BLACK_7_UNIT 1', 'BLACK_7_UNIT 2', 'PIT6_7_UNIT 1', 'PIT6_7_UNIT 2', 'PIT7_7_UNIT 1', 'PIT7_7_UNIT 2', 'COLEMN_2_UNIT' "
strSQL = strSQL & " , 'COWCRK_2_UNIT', 'INSKIP_2_UNIT', 'KILARC_2_UNIT 1', 'SOUTH_2_UNIT', 'VOLTA_2_UNIT 1', 'VOLTA_2_UNIT 2', 'HMLTBR_6_UNITS', 'BUTTVL_7_UNIT 1' "
strSQL = strSQL & " , 'CARBOU_7_UNIT 1', 'CARBOU_7_PL2X3', 'CARBOU_7_PL4X5', 'BUCKCK_7_OAKFLT', 'BELDEN_7_UNIT 1', 'RCKCRK_7_UNIT 1', 'RCKCRK_7_UNIT 2' "
strSQL = strSQL & " , 'BUCKCK_7_PL1X2', 'CRESTA_7_PL1X2', 'POEPH_7_UNIT 1', 'POEPH_7_UNIT 2', 'POTTER_6_UNITS', 'TOADTW_6_UNIT', 'DSABLA_7_UNIT', 'CNTRVL_6_UNIT' "
strSQL = strSQL & " , 'CLRKRD_6_LIMESD', 'NAROW1_2_UNIT', 'SPAULD_6_UNIT12', 'SPAULD_6_UNIT 3', 'DEERCR_6_UNIT 1', 'DRUM_7_PL1X2', 'DRUM_7_PL3X4', 'DRUM_7_UNIT 5' "
strSQL = strSQL & " , 'BNNIEN_7_ALTAPH', 'DUTCH1_7_UNIT 1', 'HALSEY_6_UNIT', 'WISE_1_UNIT 1', 'WISE_1_UNIT 2', 'NWCSTL_7_UNIT 1', 'PLACVL_1_CHILIB', 'SALTSP_7_UNITS' "
strSQL = strSQL & " , 'TIGRCK_7_UNITS', 'WESTPT_2_UNIT', 'ELECTR_7_PL1X3', 'SPRGAP_1_UNIT 1', 'STANIS_7_UNIT 1', 'PHOENX_1_UNIT', 'MERCFL_6_UNIT', 'HAASPH_7_PL1X2' "
strSQL = strSQL & " , 'BALCHS_7_UNIT 1', 'BALCHS_7_UNIT 2', 'BALCHS_7_UNIT 3', 'KINGRV_7_UNIT 1', 'CRNEVL_6_CRNVA', 'WISHON_6_UNITS', 'CRNEVL_6_SJQN 2' "
strSQL = strSQL & " , 'CRNEVL_6_SJQN 3', 'KERKH1_7_UNIT 1', 'KERKH1_7_UNIT 3', 'KERKH2_7_UNIT 1', 'SPRGVL_2_TULE', 'KRNCNY_6_UNIT')) bt "
strSQL = strSQL & " JOIN hyp_time_intervals t ON t.total_intervals = bt.intervalcount)  "
strSQL = strSQL & " UNION ALL "
strSQL = strSQL & " (SELECT a.name "
strSQL = strSQL & " , a.trade_date "
strSQL = strSQL & " , a.attributevalue1  "
strSQL = strSQL & " , a.attributevalue2  "
strSQL = strSQL & " , a.attributevalue3  "
strSQL = strSQL & " , t.hour "
strSQL = strSQL & " , t.interval "
strSQL = strSQL & " , CASE t.interval "
strSQL = strSQL & " WHEN 1 THEN to_number(nvl(a.int001,0)) "
strSQL = strSQL & " WHEN 2 THEN to_number(nvl(a.int002,0)) "
strSQL = strSQL & " WHEN 3 THEN to_number(nvl(a.int003,0)) "
strSQL = strSQL & " WHEN 4 THEN to_number(nvl(a.int004,0)) "
strSQL = strSQL & " WHEN 5 THEN to_number(nvl(a.int005,0)) "
strSQL = strSQL & " WHEN 6 THEN to_number(nvl(a.int006,0)) "
strSQL = strSQL & " WHEN 7 THEN to_number(nvl(a.int007,0)) "
strSQL = strSQL & " WHEN 8 THEN to_number(nvl(a.int008,0)) "
strSQL = strSQL & " WHEN 9 THEN to_number(nvl(a.int009,0)) "
strSQL = strSQL & " WHEN 10 THEN to_number(nvl(a.int010,0)) "
strSQL = strSQL & " WHEN 11 THEN to_number(nvl(a.int011,0)) "
strSQL = strSQL & " WHEN 12 THEN to_number(nvl(a.int012,0)) "
strSQL = strSQL & " WHEN 13 THEN to_number(nvl(a.int013,0)) "
strSQL = strSQL & " WHEN 14 THEN to_number(nvl(a.int014,0)) "
strSQL = strSQL & " WHEN 15 THEN to_number(nvl(a.int015,0)) "
strSQL = strSQL & " WHEN 16 THEN to_number(nvl(a.int016,0)) "
strSQL = strSQL & " WHEN 17 THEN to_number(nvl(a.int017,0)) "
strSQL = strSQL & " WHEN 18 THEN to_number(nvl(a.int018,0)) "
strSQL = strSQL & " WHEN 19 THEN to_number(nvl(a.int019,0)) "
strSQL = strSQL & " WHEN 20 THEN to_number(nvl(a.int020,0)) "
strSQL = strSQL & " WHEN 21 THEN to_number(nvl(a.int021,0)) "
strSQL = strSQL & " WHEN 22 THEN to_number(nvl(a.int022,0)) "
strSQL = strSQL & " WHEN 23 THEN to_number(nvl(a.int023,0)) "
strSQL = strSQL & " WHEN 24 THEN to_number(nvl(a.int024,0)) "
strSQL = strSQL & " WHEN 25 THEN to_number(nvl(a.int025,0)) "
strSQL = strSQL & " WHEN 26 THEN to_number(nvl(a.int026,0)) "
strSQL = strSQL & " WHEN 27 THEN to_number(nvl(a.int027,0)) "
strSQL = strSQL & " WHEN 28 THEN to_number(nvl(a.int028,0)) "
strSQL = strSQL & " WHEN 29 THEN to_number(nvl(a.int029,0)) "
strSQL = strSQL & " WHEN 30 THEN to_number(nvl(a.int030,0)) "
strSQL = strSQL & " WHEN 31 THEN to_number(nvl(a.int031,0)) "
strSQL = strSQL & " WHEN 32 THEN to_number(nvl(a.int032,0)) "
strSQL = strSQL & " WHEN 33 THEN to_number(nvl(a.int033,0)) "
strSQL = strSQL & " WHEN 34 THEN to_number(nvl(a.int034,0)) "
strSQL = strSQL & " WHEN 35 THEN to_number(nvl(a.int035,0)) "
strSQL = strSQL & " WHEN 36 THEN to_number(nvl(a.int036,0)) "
strSQL = strSQL & " WHEN 37 THEN to_number(nvl(a.int037,0)) "
strSQL = strSQL & " WHEN 38 THEN to_number(nvl(a.int038,0)) "
strSQL = strSQL & " WHEN 39 THEN to_number(nvl(a.int039,0)) "
strSQL = strSQL & " WHEN 40 THEN to_number(nvl(a.int040,0)) "
strSQL = strSQL & " WHEN 41 THEN to_number(nvl(a.int041,0)) "
strSQL = strSQL & " WHEN 42 THEN to_number(nvl(a.int042,0)) "
strSQL = strSQL & " WHEN 43 THEN to_number(nvl(a.int043,0)) "
strSQL = strSQL & " WHEN 44 THEN to_number(nvl(a.int044,0)) "
strSQL = strSQL & " WHEN 45 THEN to_number(nvl(a.int045,0)) "
strSQL = strSQL & " WHEN 46 THEN to_number(nvl(a.int046,0)) "
strSQL = strSQL & " WHEN 47 THEN to_number(nvl(a.int047,0)) "
strSQL = strSQL & " WHEN 48 THEN to_number(nvl(a.int048,0)) "
strSQL = strSQL & " WHEN 49 THEN to_number(nvl(a.int049,0)) "
strSQL = strSQL & " WHEN 50 THEN to_number(nvl(a.int050,0)) "
strSQL = strSQL & " WHEN 51 THEN to_number(nvl(a.int051,0)) "
strSQL = strSQL & " WHEN 52 THEN to_number(nvl(a.int052,0)) "
strSQL = strSQL & " WHEN 53 THEN to_number(nvl(a.int053,0)) "
strSQL = strSQL & " WHEN 54 THEN to_number(nvl(a.int054,0)) "
strSQL = strSQL & " WHEN 55 THEN to_number(nvl(a.int055,0)) "
strSQL = strSQL & " WHEN 56 THEN to_number(nvl(a.int056,0)) "
strSQL = strSQL & " WHEN 57 THEN to_number(nvl(a.int057,0)) "
strSQL = strSQL & " WHEN 58 THEN to_number(nvl(a.int058,0)) "
strSQL = strSQL & " WHEN 59 THEN to_number(nvl(a.int059,0)) "
strSQL = strSQL & " WHEN 60 THEN to_number(nvl(a.int060,0)) "
strSQL = strSQL & " WHEN 61 THEN to_number(nvl(a.int061,0)) "
strSQL = strSQL & " WHEN 62 THEN to_number(nvl(a.int062,0)) "
strSQL = strSQL & " WHEN 63 THEN to_number(nvl(a.int063,0)) "
strSQL = strSQL & " WHEN 64 THEN to_number(nvl(a.int064,0)) "
strSQL = strSQL & " WHEN 65 THEN to_number(nvl(a.int065,0)) "
strSQL = strSQL & " WHEN 66 THEN to_number(nvl(a.int066,0)) "
strSQL = strSQL & " WHEN 67 THEN to_number(nvl(a.int067,0)) "
strSQL = strSQL & " WHEN 68 THEN to_number(nvl(a.int068,0)) "
strSQL = strSQL & " WHEN 69 THEN to_number(nvl(a.int069,0)) "
strSQL = strSQL & " WHEN 70 THEN to_number(nvl(a.int070,0)) "
strSQL = strSQL & " WHEN 71 THEN to_number(nvl(a.int071,0)) "
strSQL = strSQL & " WHEN 72 THEN to_number(nvl(a.int072,0)) "
strSQL = strSQL & " WHEN 73 THEN to_number(nvl(a.int073,0)) "
strSQL = strSQL & " WHEN 74 THEN to_number(nvl(a.int074,0)) "
strSQL = strSQL & " WHEN 75 THEN to_number(nvl(a.int075,0)) "
strSQL = strSQL & " WHEN 76 THEN to_number(nvl(a.int076,0)) "
strSQL = strSQL & " WHEN 77 THEN to_number(nvl(a.int077,0)) "
strSQL = strSQL & " WHEN 78 THEN to_number(nvl(a.int078,0)) "
strSQL = strSQL & " WHEN 79 THEN to_number(nvl(a.int079,0)) "
strSQL = strSQL & " WHEN 80 THEN to_number(nvl(a.int080,0)) "
strSQL = strSQL & " WHEN 81 THEN to_number(nvl(a.int081,0)) "
strSQL = strSQL & " WHEN 82 THEN to_number(nvl(a.int082,0)) "
strSQL = strSQL & " WHEN 83 THEN to_number(nvl(a.int083,0)) "
strSQL = strSQL & " WHEN 84 THEN to_number(nvl(a.int084,0)) "
strSQL = strSQL & " WHEN 85 THEN to_number(nvl(a.int085,0)) "
strSQL = strSQL & " WHEN 86 THEN to_number(nvl(a.int086,0)) "
strSQL = strSQL & " WHEN 87 THEN to_number(nvl(a.int087,0)) "
strSQL = strSQL & " WHEN 88 THEN to_number(nvl(a.int088,0)) "
strSQL = strSQL & " WHEN 89 THEN to_number(nvl(a.int089,0)) "
strSQL = strSQL & " WHEN 90 THEN to_number(nvl(a.int090,0)) "
strSQL = strSQL & " WHEN 91 THEN to_number(nvl(a.int091,0)) "
strSQL = strSQL & " WHEN 92 THEN to_number(nvl(a.int092,0)) "
strSQL = strSQL & " WHEN 93 THEN to_number(nvl(a.int093,0)) "
strSQL = strSQL & " WHEN 94 THEN to_number(nvl(a.int094,0)) "
strSQL = strSQL & " WHEN 95 THEN to_number(nvl(a.int095,0)) "
strSQL = strSQL & " WHEN 96 THEN to_number(nvl(a.int096,0)) "
strSQL = strSQL & " WHEN 97 THEN to_number(nvl(a.int097,0)) "
strSQL = strSQL & " WHEN 98 THEN to_number(nvl(a.int098,0)) "
strSQL = strSQL & " WHEN 99 THEN to_number(nvl(a.int099,0)) "
strSQL = strSQL & " WHEN 100 THEN to_number(nvl(a.int100,0)) "
strSQL = strSQL & " WHEN 101 THEN to_number(nvl(a.int101,0)) "
strSQL = strSQL & " WHEN 102 THEN to_number(nvl(a.int102,0)) "
strSQL = strSQL & " WHEN 103 THEN to_number(nvl(a.int103,0)) "
strSQL = strSQL & " WHEN 104 THEN to_number(nvl(a.int104,0)) "
strSQL = strSQL & " WHEN 105 THEN to_number(nvl(a.int105,0)) "
strSQL = strSQL & " WHEN 106 THEN to_number(nvl(a.int106,0)) "
strSQL = strSQL & " WHEN 107 THEN to_number(nvl(a.int107,0)) "
strSQL = strSQL & " WHEN 108 THEN to_number(nvl(a.int108,0)) "
strSQL = strSQL & " WHEN 109 THEN to_number(nvl(a.int109,0)) "
strSQL = strSQL & " WHEN 110 THEN to_number(nvl(a.int110,0)) "
strSQL = strSQL & " WHEN 111 THEN to_number(nvl(a.int111,0)) "
strSQL = strSQL & " WHEN 112 THEN to_number(nvl(a.int112,0)) "
strSQL = strSQL & " WHEN 113 THEN to_number(nvl(a.int113,0)) "
strSQL = strSQL & " WHEN 114 THEN to_number(nvl(a.int114,0)) "
strSQL = strSQL & " WHEN 115 THEN to_number(nvl(a.int115,0)) "
strSQL = strSQL & " WHEN 116 THEN to_number(nvl(a.int116,0)) "
strSQL = strSQL & " WHEN 117 THEN to_number(nvl(a.int117,0)) "
strSQL = strSQL & " WHEN 118 THEN to_number(nvl(a.int118,0)) "
strSQL = strSQL & " WHEN 119 THEN to_number(nvl(a.int119,0)) "
strSQL = strSQL & " WHEN 120 THEN to_number(nvl(a.int120,0)) "
strSQL = strSQL & " WHEN 121 THEN to_number(nvl(a.int121,0)) "
strSQL = strSQL & " WHEN 122 THEN to_number(nvl(a.int122,0)) "
strSQL = strSQL & " WHEN 123 THEN to_number(nvl(a.int123,0)) "
strSQL = strSQL & " WHEN 124 THEN to_number(nvl(a.int124,0)) "
strSQL = strSQL & " WHEN 125 THEN to_number(nvl(a.int125,0)) "
strSQL = strSQL & " WHEN 126 THEN to_number(nvl(a.int126,0)) "
strSQL = strSQL & " WHEN 127 THEN to_number(nvl(a.int127,0)) "
strSQL = strSQL & " WHEN 128 THEN to_number(nvl(a.int128,0)) "
strSQL = strSQL & " WHEN 129 THEN to_number(nvl(a.int129,0)) "
strSQL = strSQL & " WHEN 130 THEN to_number(nvl(a.int130,0)) "
strSQL = strSQL & " WHEN 131 THEN to_number(nvl(a.int131,0)) "
strSQL = strSQL & " WHEN 132 THEN to_number(nvl(a.int132,0)) "
strSQL = strSQL & " WHEN 133 THEN to_number(nvl(a.int133,0)) "
strSQL = strSQL & " WHEN 134 THEN to_number(nvl(a.int134,0)) "
strSQL = strSQL & " WHEN 135 THEN to_number(nvl(a.int135,0)) "
strSQL = strSQL & " WHEN 136 THEN to_number(nvl(a.int136,0)) "
strSQL = strSQL & " WHEN 137 THEN to_number(nvl(a.int137,0)) "
strSQL = strSQL & " WHEN 138 THEN to_number(nvl(a.int138,0)) "
strSQL = strSQL & " WHEN 139 THEN to_number(nvl(a.int139,0)) "
strSQL = strSQL & " WHEN 140 THEN to_number(nvl(a.int140,0)) "
strSQL = strSQL & " WHEN 141 THEN to_number(nvl(a.int141,0)) "
strSQL = strSQL & " WHEN 142 THEN to_number(nvl(a.int142,0)) "
strSQL = strSQL & " WHEN 143 THEN to_number(nvl(a.int143,0)) "
strSQL = strSQL & " WHEN 144 THEN to_number(nvl(a.int144,0)) "
strSQL = strSQL & " WHEN 145 THEN to_number(nvl(a.int145,0)) "
strSQL = strSQL & " WHEN 146 THEN to_number(nvl(a.int146,0)) "
strSQL = strSQL & " WHEN 147 THEN to_number(nvl(a.int147,0)) "
strSQL = strSQL & " WHEN 148 THEN to_number(nvl(a.int148,0)) "
strSQL = strSQL & " WHEN 149 THEN to_number(nvl(a.int149,0)) "
strSQL = strSQL & " WHEN 150 THEN to_number(nvl(a.int150,0)) "
strSQL = strSQL & " WHEN 151 THEN to_number(nvl(a.int151,0)) "
strSQL = strSQL & " WHEN 152 THEN to_number(nvl(a.int152,0)) "
strSQL = strSQL & " WHEN 153 THEN to_number(nvl(a.int153,0)) "
strSQL = strSQL & " WHEN 154 THEN to_number(nvl(a.int154,0)) "
strSQL = strSQL & " WHEN 155 THEN to_number(nvl(a.int155,0)) "
strSQL = strSQL & " WHEN 156 THEN to_number(nvl(a.int156,0)) "
strSQL = strSQL & " WHEN 157 THEN to_number(nvl(a.int157,0)) "
strSQL = strSQL & " WHEN 158 THEN to_number(nvl(a.int158,0)) "
strSQL = strSQL & " WHEN 159 THEN to_number(nvl(a.int159,0)) "
strSQL = strSQL & " WHEN 160 THEN to_number(nvl(a.int160,0)) "
strSQL = strSQL & " WHEN 161 THEN to_number(nvl(a.int161,0)) "
strSQL = strSQL & " WHEN 162 THEN to_number(nvl(a.int162,0)) "
strSQL = strSQL & " WHEN 163 THEN to_number(nvl(a.int163,0)) "
strSQL = strSQL & " WHEN 164 THEN to_number(nvl(a.int164,0)) "
strSQL = strSQL & " WHEN 165 THEN to_number(nvl(a.int165,0)) "
strSQL = strSQL & " WHEN 166 THEN to_number(nvl(a.int166,0)) "
strSQL = strSQL & " WHEN 167 THEN to_number(nvl(a.int167,0)) "
strSQL = strSQL & " WHEN 168 THEN to_number(nvl(a.int168,0)) "
strSQL = strSQL & " WHEN 169 THEN to_number(nvl(a.int169,0)) "
strSQL = strSQL & " WHEN 170 THEN to_number(nvl(a.int170,0)) "
strSQL = strSQL & " WHEN 171 THEN to_number(nvl(a.int171,0)) "
strSQL = strSQL & " WHEN 172 THEN to_number(nvl(a.int172,0)) "
strSQL = strSQL & " WHEN 173 THEN to_number(nvl(a.int173,0)) "
strSQL = strSQL & " WHEN 174 THEN to_number(nvl(a.int174,0)) "
strSQL = strSQL & " WHEN 175 THEN to_number(nvl(a.int175,0)) "
strSQL = strSQL & " WHEN 176 THEN to_number(nvl(a.int176,0)) "
strSQL = strSQL & " WHEN 177 THEN to_number(nvl(a.int177,0)) "
strSQL = strSQL & " WHEN 178 THEN to_number(nvl(a.int178,0)) "
strSQL = strSQL & " WHEN 179 THEN to_number(nvl(a.int179,0)) "
strSQL = strSQL & " WHEN 180 THEN to_number(nvl(a.int180,0)) "
strSQL = strSQL & " WHEN 181 THEN to_number(nvl(a.int181,0)) "
strSQL = strSQL & " WHEN 182 THEN to_number(nvl(a.int182,0)) "
strSQL = strSQL & " WHEN 183 THEN to_number(nvl(a.int183,0)) "
strSQL = strSQL & " WHEN 184 THEN to_number(nvl(a.int184,0)) "
strSQL = strSQL & " WHEN 185 THEN to_number(nvl(a.int185,0)) "
strSQL = strSQL & " WHEN 186 THEN to_number(nvl(a.int186,0)) "
strSQL = strSQL & " WHEN 187 THEN to_number(nvl(a.int187,0)) "
strSQL = strSQL & " WHEN 188 THEN to_number(nvl(a.int188,0)) "
strSQL = strSQL & " WHEN 189 THEN to_number(nvl(a.int189,0)) "
strSQL = strSQL & " WHEN 190 THEN to_number(nvl(a.int190,0)) "
strSQL = strSQL & " WHEN 191 THEN to_number(nvl(a.int191,0)) "
strSQL = strSQL & " WHEN 192 THEN to_number(nvl(a.int192,0)) "
strSQL = strSQL & " WHEN 193 THEN to_number(nvl(a.int193,0)) "
strSQL = strSQL & " WHEN 194 THEN to_number(nvl(a.int194,0)) "
strSQL = strSQL & " WHEN 195 THEN to_number(nvl(a.int195,0)) "
strSQL = strSQL & " WHEN 196 THEN to_number(nvl(a.int196,0)) "
strSQL = strSQL & " WHEN 197 THEN to_number(nvl(a.int197,0)) "
strSQL = strSQL & " WHEN 198 THEN to_number(nvl(a.int198,0)) "
strSQL = strSQL & " WHEN 199 THEN to_number(nvl(a.int199,0)) "
strSQL = strSQL & " WHEN 200 THEN to_number(nvl(a.int200,0)) "
strSQL = strSQL & " WHEN 201 THEN to_number(nvl(a.int201,0)) "
strSQL = strSQL & " WHEN 202 THEN to_number(nvl(a.int202,0)) "
strSQL = strSQL & " WHEN 203 THEN to_number(nvl(a.int203,0)) "
strSQL = strSQL & " WHEN 204 THEN to_number(nvl(a.int204,0)) "
strSQL = strSQL & " WHEN 205 THEN to_number(nvl(a.int205,0)) "
strSQL = strSQL & " WHEN 206 THEN to_number(nvl(a.int206,0)) "
strSQL = strSQL & " WHEN 207 THEN to_number(nvl(a.int207,0)) "
strSQL = strSQL & " WHEN 208 THEN to_number(nvl(a.int208,0)) "
strSQL = strSQL & " WHEN 209 THEN to_number(nvl(a.int209,0)) "
strSQL = strSQL & " WHEN 210 THEN to_number(nvl(a.int210,0)) "
strSQL = strSQL & " WHEN 211 THEN to_number(nvl(a.int211,0)) "
strSQL = strSQL & " WHEN 212 THEN to_number(nvl(a.int212,0)) "
strSQL = strSQL & " WHEN 213 THEN to_number(nvl(a.int213,0)) "
strSQL = strSQL & " WHEN 214 THEN to_number(nvl(a.int214,0)) "
strSQL = strSQL & " WHEN 215 THEN to_number(nvl(a.int215,0)) "
strSQL = strSQL & " WHEN 216 THEN to_number(nvl(a.int216,0)) "
strSQL = strSQL & " WHEN 217 THEN to_number(nvl(a.int217,0)) "
strSQL = strSQL & " WHEN 218 THEN to_number(nvl(a.int218,0)) "
strSQL = strSQL & " WHEN 219 THEN to_number(nvl(a.int219,0)) "
strSQL = strSQL & " WHEN 220 THEN to_number(nvl(a.int220,0)) "
strSQL = strSQL & " WHEN 221 THEN to_number(nvl(a.int221,0)) "
strSQL = strSQL & " WHEN 222 THEN to_number(nvl(a.int222,0)) "
strSQL = strSQL & " WHEN 223 THEN to_number(nvl(a.int223,0)) "
strSQL = strSQL & " WHEN 224 THEN to_number(nvl(a.int224,0)) "
strSQL = strSQL & " WHEN 225 THEN to_number(nvl(a.int225,0)) "
strSQL = strSQL & " WHEN 226 THEN to_number(nvl(a.int226,0)) "
strSQL = strSQL & " WHEN 227 THEN to_number(nvl(a.int227,0)) "
strSQL = strSQL & " WHEN 228 THEN to_number(nvl(a.int228,0)) "
strSQL = strSQL & " WHEN 229 THEN to_number(nvl(a.int229,0)) "
strSQL = strSQL & " WHEN 230 THEN to_number(nvl(a.int230,0)) "
strSQL = strSQL & " WHEN 231 THEN to_number(nvl(a.int231,0)) "
strSQL = strSQL & " WHEN 232 THEN to_number(nvl(a.int232,0)) "
strSQL = strSQL & " WHEN 233 THEN to_number(nvl(a.int233,0)) "
strSQL = strSQL & " WHEN 234 THEN to_number(nvl(a.int234,0)) "
strSQL = strSQL & " WHEN 235 THEN to_number(nvl(a.int235,0)) "
strSQL = strSQL & " WHEN 236 THEN to_number(nvl(a.int236,0)) "
strSQL = strSQL & " WHEN 237 THEN to_number(nvl(a.int237,0)) "
strSQL = strSQL & " WHEN 238 THEN to_number(nvl(a.int238,0)) "
strSQL = strSQL & " WHEN 239 THEN to_number(nvl(a.int239,0)) "
strSQL = strSQL & " WHEN 240 THEN to_number(nvl(a.int240,0)) "
strSQL = strSQL & " WHEN 241 THEN to_number(nvl(a.int241,0)) "
strSQL = strSQL & " WHEN 242 THEN to_number(nvl(a.int242,0)) "
strSQL = strSQL & " WHEN 243 THEN to_number(nvl(a.int243,0)) "
strSQL = strSQL & " WHEN 244 THEN to_number(nvl(a.int244,0)) "
strSQL = strSQL & " WHEN 245 THEN to_number(nvl(a.int245,0)) "
strSQL = strSQL & " WHEN 246 THEN to_number(nvl(a.int246,0)) "
strSQL = strSQL & " WHEN 247 THEN to_number(nvl(a.int247,0)) "
strSQL = strSQL & " WHEN 248 THEN to_number(nvl(a.int248,0)) "
strSQL = strSQL & " WHEN 249 THEN to_number(nvl(a.int249,0)) "
strSQL = strSQL & " WHEN 250 THEN to_number(nvl(a.int250,0)) "
strSQL = strSQL & " WHEN 251 THEN to_number(nvl(a.int251,0)) "
strSQL = strSQL & " WHEN 252 THEN to_number(nvl(a.int252,0)) "
strSQL = strSQL & " WHEN 253 THEN to_number(nvl(a.int253,0)) "
strSQL = strSQL & " WHEN 254 THEN to_number(nvl(a.int254,0)) "
strSQL = strSQL & " WHEN 255 THEN to_number(nvl(a.int255,0)) "
strSQL = strSQL & " WHEN 256 THEN to_number(nvl(a.int256,0)) "
strSQL = strSQL & " WHEN 257 THEN to_number(nvl(a.int257,0)) "
strSQL = strSQL & " WHEN 258 THEN to_number(nvl(a.int258,0)) "
strSQL = strSQL & " WHEN 259 THEN to_number(nvl(a.int259,0)) "
strSQL = strSQL & " WHEN 260 THEN to_number(nvl(a.int260,0)) "
strSQL = strSQL & " WHEN 261 THEN to_number(nvl(a.int261,0)) "
strSQL = strSQL & " WHEN 262 THEN to_number(nvl(a.int262,0)) "
strSQL = strSQL & " WHEN 263 THEN to_number(nvl(a.int263,0)) "
strSQL = strSQL & " WHEN 264 THEN to_number(nvl(a.int264,0)) "
strSQL = strSQL & " WHEN 265 THEN to_number(nvl(a.int265,0)) "
strSQL = strSQL & " WHEN 266 THEN to_number(nvl(a.int266,0)) "
strSQL = strSQL & " WHEN 267 THEN to_number(nvl(a.int267,0)) "
strSQL = strSQL & " WHEN 268 THEN to_number(nvl(a.int268,0)) "
strSQL = strSQL & " WHEN 269 THEN to_number(nvl(a.int269,0)) "
strSQL = strSQL & " WHEN 270 THEN to_number(nvl(a.int270,0)) "
strSQL = strSQL & " WHEN 271 THEN to_number(nvl(a.int271,0)) "
strSQL = strSQL & " WHEN 272 THEN to_number(nvl(a.int272,0)) "
strSQL = strSQL & " WHEN 273 THEN to_number(nvl(a.int273,0)) "
strSQL = strSQL & " WHEN 274 THEN to_number(nvl(a.int274,0)) "
strSQL = strSQL & " WHEN 275 THEN to_number(nvl(a.int275,0)) "
strSQL = strSQL & " WHEN 276 THEN to_number(nvl(a.int276,0)) "
strSQL = strSQL & " WHEN 277 THEN to_number(nvl(a.int277,0)) "
strSQL = strSQL & " WHEN 278 THEN to_number(nvl(a.int278,0)) "
strSQL = strSQL & " WHEN 279 THEN to_number(nvl(a.int279,0)) "
strSQL = strSQL & " WHEN 280 THEN to_number(nvl(a.int280,0)) "
strSQL = strSQL & " WHEN 281 THEN to_number(nvl(a.int281,0)) "
strSQL = strSQL & " WHEN 282 THEN to_number(nvl(a.int282,0)) "
strSQL = strSQL & " WHEN 283 THEN to_number(nvl(a.int283,0)) "
strSQL = strSQL & " WHEN 284 THEN to_number(nvl(a.int284,0)) "
strSQL = strSQL & " WHEN 285 THEN to_number(nvl(a.int285,0)) "
strSQL = strSQL & " WHEN 286 THEN to_number(nvl(a.int286,0)) "
strSQL = strSQL & " WHEN 287 THEN to_number(nvl(a.int287,0)) "
strSQL = strSQL & " WHEN 288 THEN to_number(nvl(a.int288,0)) "
strSQL = strSQL & " WHEN 289 THEN to_number(nvl(a.int289,0)) "
strSQL = strSQL & " WHEN 290 THEN to_number(nvl(a.int290,0)) "
strSQL = strSQL & " WHEN 291 THEN to_number(nvl(a.int291,0)) "
strSQL = strSQL & " WHEN 292 THEN to_number(nvl(a.int292,0)) "
strSQL = strSQL & " WHEN 293 THEN to_number(nvl(a.int293,0)) "
strSQL = strSQL & " WHEN 294 THEN to_number(nvl(a.int294,0)) "
strSQL = strSQL & " WHEN 295 THEN to_number(nvl(a.int295,0)) "
strSQL = strSQL & " WHEN 296 THEN to_number(nvl(a.int296,0)) "
strSQL = strSQL & " WHEN 297 THEN to_number(nvl(a.int297,0)) "
strSQL = strSQL & " WHEN 298 THEN to_number(nvl(a.int298,0)) "
strSQL = strSQL & " WHEN 299 THEN to_number(nvl(a.int299,0)) "
strSQL = strSQL & " WHEN 300 THEN to_number(nvl(a.int300,0)) "
strSQL = strSQL & " ELSE 0 END AS VAL "
strSQL = strSQL & " FROM billdeterminant a "
strSQL = strSQL & " JOIN hyp_time_intervals t ON t.total_intervals = a.intervalcount "
strSQL = strSQL & " WHERE a.name IN ('BA_5M_RSRC_FMM_IIE_STLMT@AMOUNT','BA_5M_RSRC_FMM_IIE_STLMT_RTPG@QUANTITY','BA_5M_RSRC_IIE@AMOUNT','BA_5M_RSRC_IIE@QUANTITY','BA_5M_RSRC_UIE@AMOUNT', 'BA_5M_RSRC_TOT_UIE@QUANTITY')  "
strSQL = strSQL & " AND a.messageheaderid in (select MESSAGEHEADERID from date_details)    "
strSQL = strSQL & " AND a.attributevalue2 in ('HATCR1_7_UNIT', 'HATCR2_7_UNIT', 'PIT1_7_UNIT 1', 'PIT1_7_UNIT 2', 'PIT3_7_PL1X3', 'PIT4_7_PL1X2', 'PIT5_7_PL1X2' "
strSQL = strSQL & " , 'PIT5_7_PL3X4', 'BLACK_7_UNIT 1', 'BLACK_7_UNIT 2', 'PIT6_7_UNIT 1', 'PIT6_7_UNIT 2', 'PIT7_7_UNIT 1', 'PIT7_7_UNIT 2', 'COLEMN_2_UNIT' "
strSQL = strSQL & " , 'COWCRK_2_UNIT', 'INSKIP_2_UNIT', 'KILARC_2_UNIT 1', 'SOUTH_2_UNIT', 'VOLTA_2_UNIT 1', 'VOLTA_2_UNIT 2', 'HMLTBR_6_UNITS', 'BUTTVL_7_UNIT 1' "
strSQL = strSQL & " , 'CARBOU_7_UNIT 1', 'CARBOU_7_PL2X3', 'CARBOU_7_PL4X5', 'BUCKCK_7_OAKFLT', 'BELDEN_7_UNIT 1', 'RCKCRK_7_UNIT 1', 'RCKCRK_7_UNIT 2' "
strSQL = strSQL & " , 'BUCKCK_7_PL1X2', 'CRESTA_7_PL1X2', 'POEPH_7_UNIT 1', 'POEPH_7_UNIT 2', 'POTTER_6_UNITS', 'TOADTW_6_UNIT', 'DSABLA_7_UNIT', 'CNTRVL_6_UNIT' "
strSQL = strSQL & " , 'CLRKRD_6_LIMESD', 'NAROW1_2_UNIT', 'SPAULD_6_UNIT12', 'SPAULD_6_UNIT 3', 'DEERCR_6_UNIT 1', 'DRUM_7_PL1X2', 'DRUM_7_PL3X4', 'DRUM_7_UNIT 5' "
strSQL = strSQL & " , 'BNNIEN_7_ALTAPH', 'DUTCH1_7_UNIT 1', 'HALSEY_6_UNIT', 'WISE_1_UNIT 1', 'WISE_1_UNIT 2', 'NWCSTL_7_UNIT 1', 'PLACVL_1_CHILIB', 'SALTSP_7_UNITS' "
strSQL = strSQL & " , 'TIGRCK_7_UNITS', 'WESTPT_2_UNIT', 'ELECTR_7_PL1X3', 'SPRGAP_1_UNIT 1', 'STANIS_7_UNIT 1', 'PHOENX_1_UNIT', 'MERCFL_6_UNIT', 'HAASPH_7_PL1X2' "
strSQL = strSQL & " , 'BALCHS_7_UNIT 1', 'BALCHS_7_UNIT 2', 'BALCHS_7_UNIT 3', 'KINGRV_7_UNIT 1', 'CRNEVL_6_CRNVA', 'WISHON_6_UNITS', 'CRNEVL_6_SJQN 2' "
strSQL = strSQL & " , 'CRNEVL_6_SJQN 3', 'KERKH1_7_UNIT 1', 'KERKH1_7_UNIT 3', 'KERKH2_7_UNIT 1', 'SPRGVL_2_TULE', 'KRNCNY_6_UNIT'))) "
strSQL = strSQL & " GROUP BY attributevalue1, TRADE_DATE, attributevalue2, attributevalue3, HOUR, INTERVAL) "
strSQL = strSQL & " GROUP BY RESOURCE_NAME, RESOURCE_TYPE "

''Set Object to Run SQL Statement'
Set OraDynaset = objdatabase.DBCreateDynaset(strSQL, 0)

'Adjust Placement(for both x and y, i.e. (x+1)'
If OraDynaset.RecordCount > 0 Then
    OraDynaset.MoveFirst
    For X = 0 To OraDynaset.Fields.Count - 1
        Cells(1, X + 1) = OraDynaset.Fields(X).Name
        Cells(1, X + 1).Font.Bold = True '
    Next

    For y = 0 To OraDynaset.RecordCount - 1
        For X = 0 To OraDynaset.Fields.Count - 1
            Cells(y + 103, X + 1) = OraDynaset.Fields(X).Value
        Next
        OraDynaset.MoveNext
    Next
End If
'END MOTORING'


'Begin Settlements Run'
'Clear Previous Data
Sheets("Settlements Data").Select
With Sheets("Settlements Data")
    .Rows(103 & ":" & .Rows.Count).Delete
End With

'Enter SQL Statement'
strSQL = " WITH DATE_DETAILS AS ( "
strSQL = strSQL & " SELECT trade_Date "
strSQL = strSQL & " , BA_ID "
strSQL = strSQL & " , max(messageheaderid) messageheaderid  "
strSQL = strSQL & " , CASE WHEN run_description LIKE 'MONTHLY%' THEN 'Monthly' ELSE 'Daily' END AS Freq "
strSQL = strSQL & " FROM messageheader "
strSQL = strSQL & " WHERE trade_date BETWEEN '" & Format(DateSerial(Year(input_StartDate), Month(input_StartDate), 1), "dd-mmm-yyyy") & "' AND '" & Format(DateSerial(Year(input_EndDate), Month(input_EndDate) + 1, 1) - 1, "dd-mmm-yyyy") & "' "
strSQL = strSQL & " AND file_type = 'DETERMINANTS' "
strSQL = strSQL & " GROUP BY trade_Date, BA_ID, CASE WHEN run_description LIKE 'MONTHLY%' THEN 'Monthly' ELSE 'Daily' END) "
strSQL = strSQL & " SELECT AREA  "
strSQL = strSQL & " , RESOURCE_NAME  "
strSQL = strSQL & " , RESOURCE_TYPE  "
strSQL = strSQL & " , PRIORITY  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6011_Non_Contract),0) + NVL(to_number(CC6011_Contract),0) + NVL(to_number(CC6460),0) + NVL(to_number(CC6470),0) + NVL(to_number(CC6475),0) + NVL(to_number(CC6482),0) + NVL(to_number(CC6488),0) + NVL(to_number(CC6630),0) + NVL(to_number(CC6620),0)) AS Total_Energy_Amount  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6100),0) + NVL(to_number(CC6124),0) + NVL(to_number(CC6170),0) + NVL(to_number(CC6200),0) + NVL(to_number(CC6224),0) + NVL(to_number(CC6270),0) + NVL(to_number(CC6500),0) + NVL(to_number(CC6524),0) + NVL(to_number(CC6570),0) + NVL(to_number(CC6600),0) + NVL(to_number(CC6624),0) + NVL(to_number(CC6670),0) + NVL(to_number(CC7251),0) + NVL(to_number(CC7261),0) + NVL(to_number(CC7070_Total_Settlement),0)  "
strSQL = strSQL & " + NVL(to_number(CC7071_Total_Settlement),0) + NVL(to_number(CC7081_Total_Settlement),0) + NVL(to_number(CC7077),0) + ((-1*NVL(to_number(CC7077),0))+ NVL(to_number(CC7078_Off_Peak),0) + NVL(to_number(CC7078_Peak),0)) + NVL(to_number(CC7087),0) + ((-1*NVL(to_number(CC7087),0))+ NVL(to_number(CC7088_Off_Peak),0)   "
strSQL = strSQL & " + NVL(to_number(CC7088_Peak),0)) + NVL(to_number(CC8831),0) + NVL(to_number(CC8830),0)) AS Total_Capacity_Amount  "
strSQL = strSQL & " , SUM(NVL(to_number(Total_DA_MWh),0)) AS Total_DA_MWh  "
strSQL = strSQL & " , SUM(NVL(to_number(Total_FMM_MWh),0)+NVL(to_number(Total_IIE_MWh),0)) AS Total_RTM_MWh  "
strSQL = strSQL & " , SUM(NVL(to_number(Total_Output_MWh),0)) AS Total_Output_MWh  "
strSQL = strSQL & " , SUM(NVL(to_number(Uninstructed_MWh_Gross),0)) AS Uninstructed_MWh_Gross  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6475),0)) AS CC6475  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6100),0)+NVL(to_number(CC6170),0)) AS CC6100_6170  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6200),0)+NVL(to_number(CC6270),0)) AS CC6200_6270  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6500),0)+NVL(to_number(CC6570),0)) AS CC6500_6570  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6600),0)+NVL(to_number(CC6670),0)) AS CC6600_6670  "
strSQL = strSQL & " , SUM(NVL(to_number(CC6124),0)+NVL(to_number(CC6224),0)+NVL(to_number(CC6524),0)+NVL(to_number(CC6624),0)) AS Net_No_Pay  "
strSQL = strSQL & " , SUM(NVL(to_number(CC7070_Total_Settlement),0)) AS CC7070  "
strSQL = strSQL & " , SUM(NVL(to_number(CC7071_Total_Settlement),0)) AS CC7071    "
strSQL = strSQL & " , SUM(((-1*NVL(to_number(CC7077),0))+ NVL(to_number(CC7078_Off_Peak),0) + NVL(to_number(CC7078_Peak),0))) AS CC7078   "
strSQL = strSQL & " , SUM(NVL(to_number(CC7081_Total_Settlement),0)) AS CC7081  "
strSQL = strSQL & " , SUM(((-1*NVL(to_number(CC7087),0))+ NVL(to_number(CC7088_Off_Peak),0) + NVL(to_number(CC7088_Peak),0))) AS CC7088  "
strSQL = strSQL & " , SUM(NVL(to_number(CC8831),0)+NVL(to_number(CC8830),0)) AS RAAIM  "
strSQL = strSQL & " FROM   "
strSQL = strSQL & " (SELECT CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN 'Shasta - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN 'DeSabla - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN 'Central Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN 'Kings-Crane Valley - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 1' THEN 'Helms - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 2' THEN 'Helms - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 3' THEN 'Helms - Hydro' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 1' THEN 'Diablo Canyon' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 2' THEN 'Diablo Canyon' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_6_UNITS' THEN 'Fossil' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_1_UNITS3' THEN 'Fossil' "
strSQL = strSQL & " WHEN resource_name = 'COLUSA_2_PL1X3' THEN 'Fossil' "
strSQL = strSQL & " WHEN resource_name = 'GATWAY_2_PL1X3' THEN 'Fossil' "
strSQL = strSQL & " WHEN resource_name = 'CANTUA_1_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_FIVPTS' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'GUERNS_6_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'GIFFEN_6_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'HURON_6_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'STROUD_6_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_SOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_WSOLAR' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_WSTSDE' THEN 'Solar' "
strSQL = strSQL & " WHEN resource_name = 'CASTVL_2_FCELL' THEN 'Fuel Cell' "
strSQL = strSQL & " WHEN resource_name = 'DALYCT_1_FCELL' THEN 'Fuel Cell' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_NAS' THEN 'Energy Storage' "
strSQL = strSQL & " WHEN resource_name = 'SWIFT_1_NAS' THEN 'Energy Storage' "
strSQL = strSQL & " ELSE 'ERROR' END AS AREA "
strSQL = strSQL & " , CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN 'Hat Creek 1' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN 'Hat Creek 2' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN 'Pit 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN 'Pit 1 U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN 'Pit 3 U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN 'Pit 4 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN 'Pit 5 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN 'Pit 5 U3 and U4' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN 'James B Black U1' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN 'James B Black U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN 'Pit 6 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN 'Pit 6 U2' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN 'Pit 7 U1' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN 'Pit 7 U2' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN 'Coleman' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN 'Cow Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN 'Inskip' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN 'Kilarc U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN 'South' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN 'Volta 1' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN 'Volta 2' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN 'Hamilton Branch U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN 'Butt Valley' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN 'Caribou 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN 'Caribou 1 U2 and U3' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN 'Caribou 2 U4 and U5' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN 'Oak Flat' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN 'Belden' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN 'Rock Creek U1' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN 'Rock Creek U2' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN 'Bucks Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN 'Cresta U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN 'Poe U1' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN 'Poe U2' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN 'Potter Valley U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN 'Toadtown' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN 'DeSabla' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN 'Centerville U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN 'Lime Saddle U1 andU2' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN 'Narrows' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN 'Spaulding 1 and 2' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN 'Spaulding 3' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN 'Deer Creek' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN 'Drum 1 U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN 'Drum 1 U3 and U4' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN 'Drum 2 U5' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN 'Alta Powerhouse' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN 'Dutch Flat 1' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN 'Halsey' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN 'Wise 1' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN 'Wise 2' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN 'Newcastle' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN 'Chili Bar' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN 'Salt Springs 1 and 2' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN 'Tiger Creek U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN 'West Point' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN 'Electra U1-U3' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN 'Spring Gap' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN 'Stanislaus' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN 'Phoenix' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN 'Merced Falls' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN 'Haas U1, Haas U2' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN 'Balch 1' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN 'Balch 2 U2' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN 'Balch 2 U3' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN 'Kings River' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN 'Crane Valley' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN 'San Joaquin 1A, AG Wishon U1-U4' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN 'San Joaquin 2' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN 'San Joaquin 3' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN 'Kerckhoff 1 U1' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN 'Kerckhoff 1 U3' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN 'Kerckhoff 2' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN 'Tule River U1 and U2' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN 'Kern Canyon' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 1' THEN 'Helms U1' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 2' THEN 'Helms U2' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 3' THEN 'Helms U3' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 1' THEN 'Diablo Canyon Unit 1' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 2' THEN 'Diablo Canyon Unit 2' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_6_UNITS' THEN 'Humboldt Bay Generating Station 1&2' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_1_UNITS3' THEN 'Humboldt Bay Generating Station 3' "
strSQL = strSQL & " WHEN resource_name = 'COLUSA_2_PL1X3' THEN 'Colusa Generating Station' "
strSQL = strSQL & " WHEN resource_name = 'GATWAY_2_PL1X3' THEN 'Gateway Generating Station' "
strSQL = strSQL & " WHEN resource_name = 'CANTUA_1_SOLAR' THEN 'Cantua' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_FIVPTS' THEN 'Five Points' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_SOLAR' THEN 'Gates Solar Station' "
strSQL = strSQL & " WHEN resource_name = 'GUERNS_6_SOLAR' THEN 'Guernsey Solar Station' "
strSQL = strSQL & " WHEN resource_name = 'GIFFEN_6_SOLAR' THEN 'Giffen' "
strSQL = strSQL & " WHEN resource_name = 'HURON_6_SOLAR' THEN 'Huron' "
strSQL = strSQL & " WHEN resource_name = 'STROUD_6_SOLAR' THEN 'Stroud' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_SOLAR' THEN 'Vaca Dixon Solar Station' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_WSOLAR' THEN 'West Gates Solar Station' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_WSTSDE' THEN 'Westside' "
strSQL = strSQL & " WHEN resource_name = 'CASTVL_2_FCELL' THEN 'CSU East Bay Fuel Cells' "
strSQL = strSQL & " WHEN resource_name = 'DALYCT_1_FCELL' THEN 'SF State Fuel Cells' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_NAS' THEN 'Vaca Dixon Battery' "
strSQL = strSQL & " WHEN resource_name = 'SWIFT_1_NAS' THEN 'Yerba Buena Battery' "
strSQL = strSQL & " ELSE 'ERROR' END AS RESOURCE_NAME "
strSQL = strSQL & " , CASE WHEN resource_name = 'HATCR1_7_UNIT' THEN '1' "
strSQL = strSQL & " WHEN resource_name = 'HATCR2_7_UNIT' THEN '2' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 1' THEN '3' "
strSQL = strSQL & " WHEN resource_name = 'PIT1_7_UNIT 2' THEN '4' "
strSQL = strSQL & " WHEN resource_name = 'PIT3_7_PL1X3' THEN '5' "
strSQL = strSQL & " WHEN resource_name = 'PIT4_7_PL1X2' THEN '6' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL1X2' THEN '7' "
strSQL = strSQL & " WHEN resource_name = 'PIT5_7_PL3X4' THEN '8' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 1' THEN '9' "
strSQL = strSQL & " WHEN resource_name = 'BLACK_7_UNIT 2' THEN '10' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 1' THEN '11' "
strSQL = strSQL & " WHEN resource_name = 'PIT6_7_UNIT 2' THEN '12' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 1' THEN '13' "
strSQL = strSQL & " WHEN resource_name = 'PIT7_7_UNIT 2' THEN '14' "
strSQL = strSQL & " WHEN resource_name = 'COLEMN_2_UNIT' THEN '15' "
strSQL = strSQL & " WHEN resource_name = 'COWCRK_2_UNIT' THEN '16' "
strSQL = strSQL & " WHEN resource_name = 'INSKIP_2_UNIT' THEN '17' "
strSQL = strSQL & " WHEN resource_name = 'KILARC_2_UNIT 1' THEN '18' "
strSQL = strSQL & " WHEN resource_name = 'SOUTH_2_UNIT' THEN '19' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 1' THEN '20' "
strSQL = strSQL & " WHEN resource_name = 'VOLTA_2_UNIT 2' THEN '21' "
strSQL = strSQL & " WHEN resource_name = 'HMLTBR_6_UNITS' THEN '22' "
strSQL = strSQL & " WHEN resource_name = 'BUTTVL_7_UNIT 1' THEN '23' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_UNIT 1' THEN '24' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL2X3' THEN '25' "
strSQL = strSQL & " WHEN resource_name = 'CARBOU_7_PL4X5' THEN '26' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_OAKFLT' THEN '27' "
strSQL = strSQL & " WHEN resource_name = 'BELDEN_7_UNIT 1' THEN '28' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 1' THEN '29' "
strSQL = strSQL & " WHEN resource_name = 'RCKCRK_7_UNIT 2' THEN '30' "
strSQL = strSQL & " WHEN resource_name = 'BUCKCK_7_PL1X2' THEN '31' "
strSQL = strSQL & " WHEN resource_name = 'CRESTA_7_PL1X2' THEN '32' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 1' THEN '33' "
strSQL = strSQL & " WHEN resource_name = 'POEPH_7_UNIT 2' THEN '34' "
strSQL = strSQL & " WHEN resource_name = 'POTTER_6_UNITS' THEN '35' "
strSQL = strSQL & " WHEN resource_name = 'TOADTW_6_UNIT' THEN '36' "
strSQL = strSQL & " WHEN resource_name = 'DSABLA_7_UNIT' THEN '37' "
strSQL = strSQL & " WHEN resource_name = 'CNTRVL_6_UNIT' THEN '38' "
strSQL = strSQL & " WHEN resource_name = 'CLRKRD_6_LIMESD' THEN '39' "
strSQL = strSQL & " WHEN resource_name = 'NAROW1_2_UNIT' THEN '40' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT12' THEN '41' "
strSQL = strSQL & " WHEN resource_name = 'SPAULD_6_UNIT 3' THEN '42' "
strSQL = strSQL & " WHEN resource_name = 'DEERCR_6_UNIT 1' THEN '43' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL1X2' THEN '44' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_PL3X4' THEN '45' "
strSQL = strSQL & " WHEN resource_name = 'DRUM_7_UNIT 5' THEN '46' "
strSQL = strSQL & " WHEN resource_name = 'BNNIEN_7_ALTAPH' THEN '47' "
strSQL = strSQL & " WHEN resource_name = 'DUTCH1_7_UNIT 1' THEN '48' "
strSQL = strSQL & " WHEN resource_name = 'HALSEY_6_UNIT' THEN '49' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 1' THEN '50' "
strSQL = strSQL & " WHEN resource_name = 'WISE_1_UNIT 2' THEN '51' "
strSQL = strSQL & " WHEN resource_name = 'NWCSTL_7_UNIT 1' THEN '52' "
strSQL = strSQL & " WHEN resource_name = 'PLACVL_1_CHILIB' THEN '53' "
strSQL = strSQL & " WHEN resource_name = 'SALTSP_7_UNITS' THEN '54' "
strSQL = strSQL & " WHEN resource_name = 'TIGRCK_7_UNITS' THEN '55' "
strSQL = strSQL & " WHEN resource_name = 'WESTPT_2_UNIT' THEN '56' "
strSQL = strSQL & " WHEN resource_name = 'ELECTR_7_PL1X3' THEN '57' "
strSQL = strSQL & " WHEN resource_name = 'SPRGAP_1_UNIT 1' THEN '58' "
strSQL = strSQL & " WHEN resource_name = 'STANIS_7_UNIT 1' THEN '59' "
strSQL = strSQL & " WHEN resource_name = 'PHOENX_1_UNIT' THEN '60' "
strSQL = strSQL & " WHEN resource_name = 'MERCFL_6_UNIT' THEN '61' "
strSQL = strSQL & " WHEN resource_name = 'HAASPH_7_PL1X2' THEN '62' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 1' THEN '63' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 2' THEN '64' "
strSQL = strSQL & " WHEN resource_name = 'BALCHS_7_UNIT 3' THEN '65' "
strSQL = strSQL & " WHEN resource_name = 'KINGRV_7_UNIT 1' THEN '66' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_CRNVA' THEN '67' "
strSQL = strSQL & " WHEN resource_name = 'WISHON_6_UNITS' THEN '68' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 2' THEN '69' "
strSQL = strSQL & " WHEN resource_name = 'CRNEVL_6_SJQN 3' THEN '70' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 1' THEN '71' "
strSQL = strSQL & " WHEN resource_name = 'KERKH1_7_UNIT 3' THEN '72' "
strSQL = strSQL & " WHEN resource_name = 'KERKH2_7_UNIT 1' THEN '73' "
strSQL = strSQL & " WHEN resource_name = 'SPRGVL_2_TULE' THEN '74' "
strSQL = strSQL & " WHEN resource_name = 'KRNCNY_6_UNIT' THEN '75' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 1' AND resource_type = 'GEN' THEN '76' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 1' AND resource_type = 'LOAD' THEN '77' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 2' AND resource_type = 'GEN' THEN '78' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 2' AND resource_type = 'LOAD' THEN '79' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 3' AND resource_type = 'GEN' THEN '80' "
strSQL = strSQL & " WHEN resource_name = 'HELMPG_7_UNIT 3' AND resource_type = 'LOAD' THEN '81' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 1' THEN '82' "
strSQL = strSQL & " WHEN resource_name = 'DIABLO_7_UNIT 2' THEN '83' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_6_UNITS' THEN '84' "
strSQL = strSQL & " WHEN resource_name = 'HUMBPP_1_UNITS3' THEN '85' "
strSQL = strSQL & " WHEN resource_name = 'COLUSA_2_PL1X3' THEN '86' "
strSQL = strSQL & " WHEN resource_name = 'GATWAY_2_PL1X3' THEN '87' "
strSQL = strSQL & " WHEN resource_name = 'CANTUA_1_SOLAR' THEN '88' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_FIVPTS' THEN '89' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_SOLAR' THEN '90' "
strSQL = strSQL & " WHEN resource_name = 'GUERNS_6_SOLAR' THEN '91' "
strSQL = strSQL & " WHEN resource_name = 'GIFFEN_6_SOLAR' THEN '92' "
strSQL = strSQL & " WHEN resource_name = 'HURON_6_SOLAR' THEN '93' "
strSQL = strSQL & " WHEN resource_name = 'STROUD_6_SOLAR' THEN '94' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_SOLAR' THEN '95' "
strSQL = strSQL & " WHEN resource_name = 'GATES_2_WSOLAR' THEN '96' "
strSQL = strSQL & " WHEN resource_name = 'SCHNDR_1_WSTSDE' THEN '97' "
strSQL = strSQL & " WHEN resource_name = 'CASTVL_2_FCELL' THEN '98' "
strSQL = strSQL & " WHEN resource_name = 'DALYCT_1_FCELL' THEN '99' "
strSQL = strSQL & " WHEN resource_name = 'VACADX_1_NAS' THEN '100' "
strSQL = strSQL & " WHEN resource_name = 'SWIFT_1_NAS' THEN '101' "
strSQL = strSQL & " ELSE 'ERROR' END AS PRIORITY "
strSQL = strSQL & " , RESOURCE_TYPE  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_DA_SCHD@QUANTITY'  THEN SUM(total) END AS Total_DA_MWh  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_FMM_IIE_STLMT_RTPG@QUANTITY'  THEN SUM(total) END AS Total_FMM_MWh  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_IIE@QUANTITY'  THEN SUM(total) END AS Total_IIE_MWh  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_METER_ENGY@QUANTITY'  THEN SUM(total) END AS Total_Output_MWh  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_TOT_UIE@QUANTITY' THEN SUM(total) END AS Uninstructed_MWh_Gross  "
strSQL = strSQL & " , CASE WHEN name = 'RSRC_HRLY_DA_ENGY_LMP_NON_CONTRACT@AMOUNT' THEN -1*SUM(total) END AS CC6011_Non_Contract  "
strSQL = strSQL & " , CASE WHEN name = 'BA_HRLY_DA_ENGY_CONTRACT@AMOUNT' THEN -1*SUM(total) END AS CC6011_Contract  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_FMM_IIE_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6460  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_IIE@AMOUNT' THEN -1*SUM(total) END AS CC6470  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_UIE@AMOUNT' THEN -1*SUM(total) END AS CC6475  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_ED_TYPE_EX_COST_IIE_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6482  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_EXCP_DISP@AMOUNT' THEN -1*SUM(total) END AS CC6488  "
strSQL = strSQL & " , CASE WHEN name = 'BA_DAY_RSRC_OR_MSS_IFM_BCR_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6630  "
strSQL = strSQL & " , CASE WHEN name = 'BA_DAY_RSRC_OR_MSS_BCR_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6620  "
strSQL = strSQL & " , CASE WHEN name = 'BA_HRLY_RSRC_DA_SPIN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6100  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_NOPAY_SPIN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6124  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RT_SPIN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6170  "
strSQL = strSQL & " , CASE WHEN name = 'BA_HRLY_RSRC_DA_NSPN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6200  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_NOPAY_NSPN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6224  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RSRC_RT_NSPN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6270  "
strSQL = strSQL & " , CASE WHEN name = 'BA_HRLY_RSRC_DA_REGUP@AMOUNT' THEN -1*SUM(total) END AS CC6500  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_NOPAY_REGUP@AMOUNT' THEN -1*SUM(total) END AS CC6524  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RSRC_RT_REGUP_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6570  "
strSQL = strSQL & " , CASE WHEN name = 'BA_HRLY_RSRC_DA_REGDOWN@AMOUNT' THEN -1*SUM(total) END AS CC6600  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_NOPAY_REGDOWN_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC6624  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RSRC_RT_REGDOWN@AMOUNT' THEN -1*SUM(total) END AS CC6670  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RSRC_REGUP_MILEAGE_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC7251  "
strSQL = strSQL & " , CASE WHEN name = 'BA_15M_RSRC_REGDOWN_MILEAGE_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC7261  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_TOT_FR_FCAST_MVMT@AMOUNT' THEN -1*SUM(total) END AS CC7070_Total_Settlement  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_TOT_FRU_UNCERT_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC7071_Total_Settlement  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_TOT_FRD_UNCERT_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC7081_Total_Settlement  "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_BAA_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7077   "
strSQL = strSQL & " , CASE WHEN name = 'BA_5M_RSRC_BAA_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7087   "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_BAA_OFFP_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7078_Off_Peak   "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_BAA_PEAK_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7078_Peak   "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_BAA_OFFP_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7088_Off_Peak   "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_BAA_PEAK_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT' THEN -1*SUM(total) END AS CC7088_Peak   "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_TOT_RAAIM_INCV_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC8831  "
strSQL = strSQL & " , CASE WHEN name = 'BA_MTH_RSRC_TOT_RAAIM_NON_AVAIL_STLMT@AMOUNT' THEN -1*SUM(total) END AS CC8830        "
strSQL = strSQL & " FROM   "
strSQL = strSQL & " ((SELECT /*+PARALLEL_INDEX(a, 50)*/ a.attributevalue2 AS resource_name  "
strSQL = strSQL & " , CASE WHEN a.name IN ('BA_DAY_RSRC_OR_MSS_IFM_BCR_STLMT@AMOUNT','BA_DAY_RSRC_OR_MSS_BCR_STLMT@AMOUNT') THEN 'GEN'  "
strSQL = strSQL & " ELSE a.attributevalue3 END AS resource_type  "
strSQL = strSQL & " , CASE WHEN a.name IN ('BA_5M_RSRC_TOT_UIE@QUANTITY') THEN     "
strSQL = strSQL & " ABS(NVL(a.int001,0)) + ABS(NVL(a.int002,0)) + ABS(NVL(a.int003,0)) + ABS(NVL(a.int004,0)) + ABS(NVL(a.int005,0)) + ABS(NVL(a.int006,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int007,0)) + ABS(NVL(a.int008,0)) + ABS(NVL(a.int009,0)) + ABS(NVL(a.int010,0)) + ABS(NVL(a.int011,0)) + ABS(NVL(a.int012,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int013,0)) + ABS(NVL(a.int014,0)) + ABS(NVL(a.int015,0)) + ABS(NVL(a.int016,0)) + ABS(NVL(a.int017,0)) + ABS(NVL(a.int018,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int019,0)) + ABS(NVL(a.int020,0)) + ABS(NVL(a.int021,0)) + ABS(NVL(a.int022,0)) + ABS(NVL(a.int023,0)) + ABS(NVL(a.int024,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int025,0)) + ABS(NVL(a.int026,0)) + ABS(NVL(a.int027,0)) + ABS(NVL(a.int028,0)) + ABS(NVL(a.int029,0)) + ABS(NVL(a.int030,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int031,0)) + ABS(NVL(a.int032,0)) + ABS(NVL(a.int033,0)) + ABS(NVL(a.int034,0)) + ABS(NVL(a.int035,0)) + ABS(NVL(a.int036,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int037,0)) + ABS(NVL(a.int038,0)) + ABS(NVL(a.int039,0)) + ABS(NVL(a.int040,0)) + ABS(NVL(a.int041,0)) + ABS(NVL(a.int042,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int043,0)) + ABS(NVL(a.int044,0)) + ABS(NVL(a.int045,0)) + ABS(NVL(a.int046,0)) + ABS(NVL(a.int047,0)) + ABS(NVL(a.int048,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int049,0)) + ABS(NVL(a.int050,0)) + ABS(NVL(a.int051,0)) + ABS(NVL(a.int052,0)) + ABS(NVL(a.int053,0)) + ABS(NVL(a.int054,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int055,0)) + ABS(NVL(a.int056,0)) + ABS(NVL(a.int057,0)) + ABS(NVL(a.int058,0)) + ABS(NVL(a.int059,0)) + ABS(NVL(a.int060,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int061,0)) + ABS(NVL(a.int062,0)) + ABS(NVL(a.int063,0)) + ABS(NVL(a.int064,0)) + ABS(NVL(a.int065,0)) + ABS(NVL(a.int066,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int067,0)) + ABS(NVL(a.int068,0)) + ABS(NVL(a.int069,0)) + ABS(NVL(a.int070,0)) + ABS(NVL(a.int071,0)) + ABS(NVL(a.int072,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int073,0)) + ABS(NVL(a.int074,0)) + ABS(NVL(a.int075,0)) + ABS(NVL(a.int076,0)) + ABS(NVL(a.int077,0)) + ABS(NVL(a.int078,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int079,0)) + ABS(NVL(a.int080,0)) + ABS(NVL(a.int081,0)) + ABS(NVL(a.int082,0)) + ABS(NVL(a.int083,0)) + ABS(NVL(a.int084,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int085,0)) + ABS(NVL(a.int086,0)) + ABS(NVL(a.int087,0)) + ABS(NVL(a.int088,0)) + ABS(NVL(a.int089,0)) + ABS(NVL(a.int090,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int091,0)) + ABS(NVL(a.int092,0)) + ABS(NVL(a.int093,0)) + ABS(NVL(a.int094,0)) + ABS(NVL(a.int095,0)) + ABS(NVL(a.int096,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int097,0)) + ABS(NVL(a.int098,0)) + ABS(NVL(a.int099,0)) + ABS(NVL(a.int100,0)) + ABS(NVL(a.int101,0)) + ABS(NVL(a.int102,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int103,0)) + ABS(NVL(a.int104,0)) + ABS(NVL(a.int105,0)) + ABS(NVL(a.int106,0)) + ABS(NVL(a.int107,0)) + ABS(NVL(a.int108,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int109,0)) + ABS(NVL(a.int110,0)) + ABS(NVL(a.int111,0)) + ABS(NVL(a.int112,0)) + ABS(NVL(a.int113,0)) + ABS(NVL(a.int114,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int115,0)) + ABS(NVL(a.int116,0)) + ABS(NVL(a.int117,0)) + ABS(NVL(a.int118,0)) + ABS(NVL(a.int119,0)) + ABS(NVL(a.int120,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int121,0)) + ABS(NVL(a.int122,0)) + ABS(NVL(a.int123,0)) + ABS(NVL(a.int124,0)) + ABS(NVL(a.int125,0)) + ABS(NVL(a.int126,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int127,0)) + ABS(NVL(a.int128,0)) + ABS(NVL(a.int129,0)) + ABS(NVL(a.int130,0)) + ABS(NVL(a.int131,0)) + ABS(NVL(a.int132,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int133,0)) + ABS(NVL(a.int134,0)) + ABS(NVL(a.int135,0)) + ABS(NVL(a.int136,0)) + ABS(NVL(a.int137,0)) + ABS(NVL(a.int138,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int139,0)) + ABS(NVL(a.int140,0)) + ABS(NVL(a.int141,0)) + ABS(NVL(a.int142,0)) + ABS(NVL(a.int143,0)) + ABS(NVL(a.int144,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int145,0)) + ABS(NVL(a.int146,0)) + ABS(NVL(a.int147,0)) + ABS(NVL(a.int148,0)) + ABS(NVL(a.int149,0)) + ABS(NVL(a.int150,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int151,0)) + ABS(NVL(a.int152,0)) + ABS(NVL(a.int153,0)) + ABS(NVL(a.int154,0)) + ABS(NVL(a.int155,0)) + ABS(NVL(a.int156,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int157,0)) + ABS(NVL(a.int158,0)) + ABS(NVL(a.int159,0)) + ABS(NVL(a.int160,0)) + ABS(NVL(a.int161,0)) + ABS(NVL(a.int162,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int163,0)) + ABS(NVL(a.int164,0)) + ABS(NVL(a.int165,0)) + ABS(NVL(a.int166,0)) + ABS(NVL(a.int167,0)) + ABS(NVL(a.int168,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int169,0)) + ABS(NVL(a.int170,0)) + ABS(NVL(a.int171,0)) + ABS(NVL(a.int172,0)) + ABS(NVL(a.int173,0)) + ABS(NVL(a.int174,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int175,0)) + ABS(NVL(a.int176,0)) + ABS(NVL(a.int177,0)) + ABS(NVL(a.int178,0)) + ABS(NVL(a.int179,0)) + ABS(NVL(a.int180,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int181,0)) + ABS(NVL(a.int182,0)) + ABS(NVL(a.int183,0)) + ABS(NVL(a.int184,0)) + ABS(NVL(a.int185,0)) + ABS(NVL(a.int186,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int187,0)) + ABS(NVL(a.int188,0)) + ABS(NVL(a.int189,0)) + ABS(NVL(a.int190,0)) + ABS(NVL(a.int191,0)) + ABS(NVL(a.int192,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int193,0)) + ABS(NVL(a.int194,0)) + ABS(NVL(a.int195,0)) + ABS(NVL(a.int196,0)) + ABS(NVL(a.int197,0)) + ABS(NVL(a.int198,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int199,0)) + ABS(NVL(a.int200,0)) + ABS(NVL(a.int201,0)) + ABS(NVL(a.int202,0)) + ABS(NVL(a.int203,0)) + ABS(NVL(a.int204,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int205,0)) + ABS(NVL(a.int206,0)) + ABS(NVL(a.int207,0)) + ABS(NVL(a.int208,0)) + ABS(NVL(a.int209,0)) + ABS(NVL(a.int210,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int211,0)) + ABS(NVL(a.int212,0)) + ABS(NVL(a.int213,0)) + ABS(NVL(a.int214,0)) + ABS(NVL(a.int215,0)) + ABS(NVL(a.int216,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int217,0)) + ABS(NVL(a.int218,0)) + ABS(NVL(a.int219,0)) + ABS(NVL(a.int220,0)) + ABS(NVL(a.int221,0)) + ABS(NVL(a.int222,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int223,0)) + ABS(NVL(a.int224,0)) + ABS(NVL(a.int225,0)) + ABS(NVL(a.int226,0)) + ABS(NVL(a.int227,0)) + ABS(NVL(a.int228,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int229,0)) + ABS(NVL(a.int230,0)) + ABS(NVL(a.int231,0)) + ABS(NVL(a.int232,0)) + ABS(NVL(a.int233,0)) + ABS(NVL(a.int234,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int235,0)) + ABS(NVL(a.int236,0)) + ABS(NVL(a.int237,0)) + ABS(NVL(a.int238,0)) + ABS(NVL(a.int239,0)) + ABS(NVL(a.int240,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int241,0)) + ABS(NVL(a.int242,0)) + ABS(NVL(a.int243,0)) + ABS(NVL(a.int244,0)) + ABS(NVL(a.int245,0)) + ABS(NVL(a.int246,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int247,0)) + ABS(NVL(a.int248,0)) + ABS(NVL(a.int249,0)) + ABS(NVL(a.int250,0)) + ABS(NVL(a.int251,0)) + ABS(NVL(a.int252,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int253,0)) + ABS(NVL(a.int254,0)) + ABS(NVL(a.int255,0)) + ABS(NVL(a.int256,0)) + ABS(NVL(a.int257,0)) + ABS(NVL(a.int258,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int259,0)) + ABS(NVL(a.int260,0)) + ABS(NVL(a.int261,0)) + ABS(NVL(a.int262,0)) + ABS(NVL(a.int263,0)) + ABS(NVL(a.int264,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int265,0)) + ABS(NVL(a.int266,0)) + ABS(NVL(a.int267,0)) + ABS(NVL(a.int268,0)) + ABS(NVL(a.int269,0)) + ABS(NVL(a.int270,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int271,0)) + ABS(NVL(a.int272,0)) + ABS(NVL(a.int273,0)) + ABS(NVL(a.int274,0)) + ABS(NVL(a.int275,0)) + ABS(NVL(a.int276,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int277,0)) + ABS(NVL(a.int278,0)) + ABS(NVL(a.int279,0)) + ABS(NVL(a.int280,0)) + ABS(NVL(a.int281,0)) + ABS(NVL(a.int282,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int283,0)) + ABS(NVL(a.int284,0)) + ABS(NVL(a.int285,0)) + ABS(NVL(a.int286,0)) + ABS(NVL(a.int287,0)) + ABS(NVL(a.int288,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int289,0)) + ABS(NVL(a.int290,0)) + ABS(NVL(a.int291,0)) + ABS(NVL(a.int292,0)) + ABS(NVL(a.int293,0)) + ABS(NVL(a.int294,0)) +   "
strSQL = strSQL & " ABS(NVL(a.int295,0)) + ABS(NVL(a.int296,0)) + ABS(NVL(a.int297,0)) + ABS(NVL(a.int298,0)) + ABS(NVL(a.int299,0)) + ABS(NVL(a.int300,0))   "
strSQL = strSQL & " ELSE NVL(a.int001,0) + NVL(a.int002,0) + NVL(a.int003,0) + NVL(a.int004,0) + NVL(a.int005,0) + NVL(a.int006,0) +    "
strSQL = strSQL & " NVL(a.int007,0) + NVL(a.int008,0) + NVL(a.int009,0) + NVL(a.int010,0) + NVL(a.int011,0) + NVL(a.int012,0) +    "
strSQL = strSQL & " NVL(a.int013,0) + NVL(a.int014,0) + NVL(a.int015,0) + NVL(a.int016,0) + NVL(a.int017,0) + NVL(a.int018,0) +    "
strSQL = strSQL & " NVL(a.int019,0) + NVL(a.int020,0) + NVL(a.int021,0) + NVL(a.int022,0) + NVL(a.int023,0) + NVL(a.int024,0) +    "
strSQL = strSQL & " NVL(a.int025,0) + NVL(a.int026,0) + NVL(a.int027,0) + NVL(a.int028,0) + NVL(a.int029,0) + NVL(a.int030,0) +    "
strSQL = strSQL & " NVL(a.int031,0) + NVL(a.int032,0) + NVL(a.int033,0) + NVL(a.int034,0) + NVL(a.int035,0) + NVL(a.int036,0) +    "
strSQL = strSQL & " NVL(a.int037,0) + NVL(a.int038,0) + NVL(a.int039,0) + NVL(a.int040,0) + NVL(a.int041,0) + NVL(a.int042,0) +    "
strSQL = strSQL & " NVL(a.int043,0) + NVL(a.int044,0) + NVL(a.int045,0) + NVL(a.int046,0) + NVL(a.int047,0) + NVL(a.int048,0) +    "
strSQL = strSQL & " NVL(a.int049,0) + NVL(a.int050,0) + NVL(a.int051,0) + NVL(a.int052,0) + NVL(a.int053,0) + NVL(a.int054,0) +    "
strSQL = strSQL & " NVL(a.int055,0) + NVL(a.int056,0) + NVL(a.int057,0) + NVL(a.int058,0) + NVL(a.int059,0) + NVL(a.int060,0) +    "
strSQL = strSQL & " NVL(a.int061,0) + NVL(a.int062,0) + NVL(a.int063,0) + NVL(a.int064,0) + NVL(a.int065,0) + NVL(a.int066,0) +    "
strSQL = strSQL & " NVL(a.int067,0) + NVL(a.int068,0) + NVL(a.int069,0) + NVL(a.int070,0) + NVL(a.int071,0) + NVL(a.int072,0) +    "
strSQL = strSQL & " NVL(a.int073,0) + NVL(a.int074,0) + NVL(a.int075,0) + NVL(a.int076,0) + NVL(a.int077,0) + NVL(a.int078,0) +    "
strSQL = strSQL & " NVL(a.int079,0) + NVL(a.int080,0) + NVL(a.int081,0) + NVL(a.int082,0) + NVL(a.int083,0) + NVL(a.int084,0) +    "
strSQL = strSQL & " NVL(a.int085,0) + NVL(a.int086,0) + NVL(a.int087,0) + NVL(a.int088,0) + NVL(a.int089,0) + NVL(a.int090,0) +    "
strSQL = strSQL & " NVL(a.int091,0) + NVL(a.int092,0) + NVL(a.int093,0) + NVL(a.int094,0) + NVL(a.int095,0) + NVL(a.int096,0) +    "
strSQL = strSQL & " NVL(a.int097,0) + NVL(a.int098,0) + NVL(a.int099,0) + NVL(a.int100,0) + NVL(a.int101,0) + NVL(a.int102,0) +    "
strSQL = strSQL & " NVL(a.int103,0) + NVL(a.int104,0) + NVL(a.int105,0) + NVL(a.int106,0) + NVL(a.int107,0) + NVL(a.int108,0) +    "
strSQL = strSQL & " NVL(a.int109,0) + NVL(a.int110,0) + NVL(a.int111,0) + NVL(a.int112,0) + NVL(a.int113,0) + NVL(a.int114,0) +    "
strSQL = strSQL & " NVL(a.int115,0) + NVL(a.int116,0) + NVL(a.int117,0) + NVL(a.int118,0) + NVL(a.int119,0) + NVL(a.int120,0) +    "
strSQL = strSQL & " NVL(a.int121,0) + NVL(a.int122,0) + NVL(a.int123,0) + NVL(a.int124,0) + NVL(a.int125,0) + NVL(a.int126,0) +    "
strSQL = strSQL & " NVL(a.int127,0) + NVL(a.int128,0) + NVL(a.int129,0) + NVL(a.int130,0) + NVL(a.int131,0) + NVL(a.int132,0) +    "
strSQL = strSQL & " NVL(a.int133,0) + NVL(a.int134,0) + NVL(a.int135,0) + NVL(a.int136,0) + NVL(a.int137,0) + NVL(a.int138,0) +    "
strSQL = strSQL & " NVL(a.int139,0) + NVL(a.int140,0) + NVL(a.int141,0) + NVL(a.int142,0) + NVL(a.int143,0) + NVL(a.int144,0) +    "
strSQL = strSQL & " NVL(a.int145,0) + NVL(a.int146,0) + NVL(a.int147,0) + NVL(a.int148,0) + NVL(a.int149,0) + NVL(a.int150,0) +    "
strSQL = strSQL & " NVL(a.int151,0) + NVL(a.int152,0) + NVL(a.int153,0) + NVL(a.int154,0) + NVL(a.int155,0) + NVL(a.int156,0) +    "
strSQL = strSQL & " NVL(a.int157,0) + NVL(a.int158,0) + NVL(a.int159,0) + NVL(a.int160,0) + NVL(a.int161,0) + NVL(a.int162,0) +    "
strSQL = strSQL & " NVL(a.int163,0) + NVL(a.int164,0) + NVL(a.int165,0) + NVL(a.int166,0) + NVL(a.int167,0) + NVL(a.int168,0) +    "
strSQL = strSQL & " NVL(a.int169,0) + NVL(a.int170,0) + NVL(a.int171,0) + NVL(a.int172,0) + NVL(a.int173,0) + NVL(a.int174,0) +    "
strSQL = strSQL & " NVL(a.int175,0) + NVL(a.int176,0) + NVL(a.int177,0) + NVL(a.int178,0) + NVL(a.int179,0) + NVL(a.int180,0) +    "
strSQL = strSQL & " NVL(a.int181,0) + NVL(a.int182,0) + NVL(a.int183,0) + NVL(a.int184,0) + NVL(a.int185,0) + NVL(a.int186,0) +    "
strSQL = strSQL & " NVL(a.int187,0) + NVL(a.int188,0) + NVL(a.int189,0) + NVL(a.int190,0) + NVL(a.int191,0) + NVL(a.int192,0) +    "
strSQL = strSQL & " NVL(a.int193,0) + NVL(a.int194,0) + NVL(a.int195,0) + NVL(a.int196,0) + NVL(a.int197,0) + NVL(a.int198,0) +    "
strSQL = strSQL & " NVL(a.int199,0) + NVL(a.int200,0) + NVL(a.int201,0) + NVL(a.int202,0) + NVL(a.int203,0) + NVL(a.int204,0) +    "
strSQL = strSQL & " NVL(a.int205,0) + NVL(a.int206,0) + NVL(a.int207,0) + NVL(a.int208,0) + NVL(a.int209,0) + NVL(a.int210,0) +    "
strSQL = strSQL & " NVL(a.int211,0) + NVL(a.int212,0) + NVL(a.int213,0) + NVL(a.int214,0) + NVL(a.int215,0) + NVL(a.int216,0) +    "
strSQL = strSQL & " NVL(a.int217,0) + NVL(a.int218,0) + NVL(a.int219,0) + NVL(a.int220,0) + NVL(a.int221,0) + NVL(a.int222,0) +    "
strSQL = strSQL & " NVL(a.int223,0) + NVL(a.int224,0) + NVL(a.int225,0) + NVL(a.int226,0) + NVL(a.int227,0) + NVL(a.int228,0) +    "
strSQL = strSQL & " NVL(a.int229,0) + NVL(a.int230,0) + NVL(a.int231,0) + NVL(a.int232,0) + NVL(a.int233,0) + NVL(a.int234,0) +    "
strSQL = strSQL & " NVL(a.int235,0) + NVL(a.int236,0) + NVL(a.int237,0) + NVL(a.int238,0) + NVL(a.int239,0) + NVL(a.int240,0) +    "
strSQL = strSQL & " NVL(a.int241,0) + NVL(a.int242,0) + NVL(a.int243,0) + NVL(a.int244,0) + NVL(a.int245,0) + NVL(a.int246,0) +    "
strSQL = strSQL & " NVL(a.int247,0) + NVL(a.int248,0) + NVL(a.int249,0) + NVL(a.int250,0) + NVL(a.int251,0) + NVL(a.int252,0) +    "
strSQL = strSQL & " NVL(a.int253,0) + NVL(a.int254,0) + NVL(a.int255,0) + NVL(a.int256,0) + NVL(a.int257,0) + NVL(a.int258,0) +    "
strSQL = strSQL & " NVL(a.int259,0) + NVL(a.int260,0) + NVL(a.int261,0) + NVL(a.int262,0) + NVL(a.int263,0) + NVL(a.int264,0) +    "
strSQL = strSQL & " NVL(a.int265,0) + NVL(a.int266,0) + NVL(a.int267,0) + NVL(a.int268,0) + NVL(a.int269,0) + NVL(a.int270,0) +    "
strSQL = strSQL & " NVL(a.int271,0) + NVL(a.int272,0) + NVL(a.int273,0) + NVL(a.int274,0) + NVL(a.int275,0) + NVL(a.int276,0) +    "
strSQL = strSQL & " NVL(a.int277,0) + NVL(a.int278,0) + NVL(a.int279,0) + NVL(a.int280,0) + NVL(a.int281,0) + NVL(a.int282,0) +    "
strSQL = strSQL & " NVL(a.int283,0) + NVL(a.int284,0) + NVL(a.int285,0) + NVL(a.int286,0) + NVL(a.int287,0) + NVL(a.int288,0) +    "
strSQL = strSQL & " NVL(a.int289,0) + NVL(a.int290,0) + NVL(a.int291,0) + NVL(a.int292,0) + NVL(a.int293,0) + NVL(a.int294,0) +    "
strSQL = strSQL & " NVL(a.int295,0) + NVL(a.int296,0) + NVL(a.int297,0) + NVL(a.int298,0) + NVL(a.int299,0) + NVL(a.int300,0)   "
strSQL = strSQL & " END AS TOTAL            "
strSQL = strSQL & " , a.name  "
strSQL = strSQL & " FROM billdeterminant a  "
strSQL = strSQL & " WHERE a.name in ('BA_5M_RSRC_DA_SCHD@QUANTITY', "
strSQL = strSQL & " 'BA_5M_RSRC_FMM_IIE_STLMT_RTPG@QUANTITY', "
strSQL = strSQL & " 'BA_5M_RSRC_IIE@QUANTITY', "
strSQL = strSQL & " 'BA_5M_RSRC_TOT_UIE@QUANTITY',  "
strSQL = strSQL & " 'BA_5M_RSRC_METER_ENGY@QUANTITY',  "
strSQL = strSQL & " 'RSRC_HRLY_DA_ENGY_LMP_NON_CONTRACT@AMOUNT',  "
strSQL = strSQL & " 'BA_HRLY_DA_ENGY_CONTRACT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_FMM_IIE_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_IIE@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_UIE@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_ED_TYPE_EX_COST_IIE_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_EXCP_DISP@AMOUNT',  "
strSQL = strSQL & " 'BA_DAY_RSRC_OR_MSS_IFM_BCR_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_DAY_RSRC_OR_MSS_BCR_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_HRLY_RSRC_DA_SPIN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_NOPAY_SPIN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RT_SPIN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_HRLY_RSRC_DA_NSPN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_NOPAY_NSPN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RSRC_RT_NSPN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_HRLY_RSRC_DA_REGUP@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_NOPAY_REGUP@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RSRC_RT_REGUP_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_HRLY_RSRC_DA_REGDOWN@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_NOPAY_REGDOWN_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RSRC_RT_REGDOWN@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RSRC_REGUP_MILEAGE_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_15M_RSRC_REGDOWN_MILEAGE_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_TOT_FR_FCAST_MVMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_TOT_FRU_UNCERT_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_TOT_FRD_UNCERT_STLMT@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_BAA_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT',  "
strSQL = strSQL & " 'BA_5M_RSRC_BAA_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT')  "
strSQL = strSQL & " AND a.attributevalue2 in ('HATCR1_7_UNIT', 'HATCR2_7_UNIT', 'PIT1_7_UNIT 1', 'PIT1_7_UNIT 2', 'PIT3_7_PL1X3', 'PIT4_7_PL1X2' "
strSQL = strSQL & " , 'PIT5_7_PL1X2', 'PIT5_7_PL3X4', 'BLACK_7_UNIT 1', 'BLACK_7_UNIT 2', 'PIT6_7_UNIT 1', 'PIT6_7_UNIT 2' "
strSQL = strSQL & " , 'PIT7_7_UNIT 1', 'PIT7_7_UNIT 2', 'COLEMN_2_UNIT', 'COWCRK_2_UNIT', 'INSKIP_2_UNIT', 'KILARC_2_UNIT 1' "
strSQL = strSQL & " , 'SOUTH_2_UNIT', 'VOLTA_2_UNIT 1', 'VOLTA_2_UNIT 2', 'HMLTBR_6_UNITS', 'BUTTVL_7_UNIT 1' "
strSQL = strSQL & " , 'CARBOU_7_UNIT 1' , 'CARBOU_7_PL2X3', 'CARBOU_7_PL4X5', 'BUCKCK_7_OAKFLT', 'BELDEN_7_UNIT 1' "
strSQL = strSQL & " , 'RCKCRK_7_UNIT 1', 'RCKCRK_7_UNIT 2', 'BUCKCK_7_PL1X2', 'CRESTA_7_PL1X2', 'POEPH_7_UNIT 1', 'POEPH_7_UNIT 2' "
strSQL = strSQL & " , 'POTTER_6_UNITS', 'TOADTW_6_UNIT', 'DSABLA_7_UNIT', 'CNTRVL_6_UNIT', 'CLRKRD_6_LIMESD', 'NAROW1_2_UNIT' "
strSQL = strSQL & " , 'SPAULD_6_UNIT12', 'SPAULD_6_UNIT 3', 'DEERCR_6_UNIT 1', 'DRUM_7_PL1X2', 'DRUM_7_PL3X4', 'DRUM_7_UNIT 5' "
strSQL = strSQL & " , 'BNNIEN_7_ALTAPH', 'DUTCH1_7_UNIT 1', 'HALSEY_6_UNIT', 'WISE_1_UNIT 1', 'WISE_1_UNIT 2', 'NWCSTL_7_UNIT 1' "
strSQL = strSQL & " , 'PLACVL_1_CHILIB', 'SALTSP_7_UNITS', 'TIGRCK_7_UNITS', 'WESTPT_2_UNIT', 'ELECTR_7_PL1X3', 'SPRGAP_1_UNIT 1' "
strSQL = strSQL & " , 'STANIS_7_UNIT 1', 'PHOENX_1_UNIT', 'MERCFL_6_UNIT', 'HAASPH_7_PL1X2', 'BALCHS_7_UNIT 1', 'BALCHS_7_UNIT 2' "
strSQL = strSQL & " , 'BALCHS_7_UNIT 3', 'KINGRV_7_UNIT 1', 'CRNEVL_6_CRNVA', 'WISHON_6_UNITS', 'CRNEVL_6_SJQN 2' "
strSQL = strSQL & " , 'CRNEVL_6_SJQN 3', 'KERKH1_7_UNIT 1', 'KERKH1_7_UNIT 3', 'KERKH2_7_UNIT 1', 'SPRGVL_2_TULE' "
strSQL = strSQL & " , 'KRNCNY_6_UNIT', 'HELMPG_7_UNIT 1', 'HELMPG_7_UNIT 1', 'HELMPG_7_UNIT 2', 'HELMPG_7_UNIT 2' "
strSQL = strSQL & " , 'HELMPG_7_UNIT 3', 'HELMPG_7_UNIT 3', 'DIABLO_7_UNIT 1', 'DIABLO_7_UNIT 2', 'HUMBPP_6_UNITS' "
strSQL = strSQL & " , 'HUMBPP_1_UNITS3', 'COLUSA_2_PL1X3', 'GATWAY_2_PL1X3', 'CANTUA_1_SOLAR', 'SCHNDR_1_FIVPTS' "
strSQL = strSQL & " , 'GATES_2_SOLAR', 'GUERNS_6_SOLAR', 'GIFFEN_6_SOLAR', 'HURON_6_SOLAR', 'STROUD_6_SOLAR' "
strSQL = strSQL & " , 'VACADX_1_SOLAR', 'GATES_2_WSOLAR', 'SCHNDR_1_WSTSDE', 'CASTVL_2_FCELL', 'DALYCT_1_FCELL' "
strSQL = strSQL & " , 'VACADX_1_NAS', 'SWIFT_1_NAS') "
strSQL = strSQL & " AND a.messageheaderid in (select MESSAGEHEADERID from date_details))    "
strSQL = strSQL & " UNION ALL  "
strSQL = strSQL & " (SELECT /*+PARALLEL_INDEX(a, 50)*/ a.attributevalue2 as resource_name  "
strSQL = strSQL & " , 'GEN' AS resource_type  "
strSQL = strSQL & " , NVL(a.int001,0) + NVL(a.int002,0) + NVL(a.int003,0) + NVL(a.int004,0) + NVL(a.int005,0) + NVL(a.int006,0) +    "
strSQL = strSQL & " NVL(a.int007,0) + NVL(a.int008,0) + NVL(a.int009,0) + NVL(a.int010,0) + NVL(a.int011,0) + NVL(a.int012,0) +    "
strSQL = strSQL & " NVL(a.int013,0) + NVL(a.int014,0) + NVL(a.int015,0) + NVL(a.int016,0) + NVL(a.int017,0) + NVL(a.int018,0) +    "
strSQL = strSQL & " NVL(a.int019,0) + NVL(a.int020,0) + NVL(a.int021,0) + NVL(a.int022,0) + NVL(a.int023,0) + NVL(a.int024,0) +    "
strSQL = strSQL & " NVL(a.int025,0) + NVL(a.int026,0) + NVL(a.int027,0) + NVL(a.int028,0) + NVL(a.int029,0) + NVL(a.int030,0) +    "
strSQL = strSQL & " NVL(a.int031,0) + NVL(a.int032,0) + NVL(a.int033,0) + NVL(a.int034,0) + NVL(a.int035,0) + NVL(a.int036,0) +    "
strSQL = strSQL & " NVL(a.int037,0) + NVL(a.int038,0) + NVL(a.int039,0) + NVL(a.int040,0) + NVL(a.int041,0) + NVL(a.int042,0) +    "
strSQL = strSQL & " NVL(a.int043,0) + NVL(a.int044,0) + NVL(a.int045,0) + NVL(a.int046,0) + NVL(a.int047,0) + NVL(a.int048,0) +    "
strSQL = strSQL & " NVL(a.int049,0) + NVL(a.int050,0) + NVL(a.int051,0) + NVL(a.int052,0) + NVL(a.int053,0) + NVL(a.int054,0) +    "
strSQL = strSQL & " NVL(a.int055,0) + NVL(a.int056,0) + NVL(a.int057,0) + NVL(a.int058,0) + NVL(a.int059,0) + NVL(a.int060,0) +    "
strSQL = strSQL & " NVL(a.int061,0) + NVL(a.int062,0) + NVL(a.int063,0) + NVL(a.int064,0) + NVL(a.int065,0) + NVL(a.int066,0) +    "
strSQL = strSQL & " NVL(a.int067,0) + NVL(a.int068,0) + NVL(a.int069,0) + NVL(a.int070,0) + NVL(a.int071,0) + NVL(a.int072,0) +    "
strSQL = strSQL & " NVL(a.int073,0) + NVL(a.int074,0) + NVL(a.int075,0) + NVL(a.int076,0) + NVL(a.int077,0) + NVL(a.int078,0) +    "
strSQL = strSQL & " NVL(a.int079,0) + NVL(a.int080,0) + NVL(a.int081,0) + NVL(a.int082,0) + NVL(a.int083,0) + NVL(a.int084,0) +    "
strSQL = strSQL & " NVL(a.int085,0) + NVL(a.int086,0) + NVL(a.int087,0) + NVL(a.int088,0) + NVL(a.int089,0) + NVL(a.int090,0) +    "
strSQL = strSQL & " NVL(a.int091,0) + NVL(a.int092,0) + NVL(a.int093,0) + NVL(a.int094,0) + NVL(a.int095,0) + NVL(a.int096,0) +    "
strSQL = strSQL & " NVL(a.int097,0) + NVL(a.int098,0) + NVL(a.int099,0) + NVL(a.int100,0) + NVL(a.int101,0) + NVL(a.int102,0) +    "
strSQL = strSQL & " NVL(a.int103,0) + NVL(a.int104,0) + NVL(a.int105,0) + NVL(a.int106,0) + NVL(a.int107,0) + NVL(a.int108,0) +    "
strSQL = strSQL & " NVL(a.int109,0) + NVL(a.int110,0) + NVL(a.int111,0) + NVL(a.int112,0) + NVL(a.int113,0) + NVL(a.int114,0) +    "
strSQL = strSQL & " NVL(a.int115,0) + NVL(a.int116,0) + NVL(a.int117,0) + NVL(a.int118,0) + NVL(a.int119,0) + NVL(a.int120,0) +    "
strSQL = strSQL & " NVL(a.int121,0) + NVL(a.int122,0) + NVL(a.int123,0) + NVL(a.int124,0) + NVL(a.int125,0) + NVL(a.int126,0) +    "
strSQL = strSQL & " NVL(a.int127,0) + NVL(a.int128,0) + NVL(a.int129,0) + NVL(a.int130,0) + NVL(a.int131,0) + NVL(a.int132,0) +    "
strSQL = strSQL & " NVL(a.int133,0) + NVL(a.int134,0) + NVL(a.int135,0) + NVL(a.int136,0) + NVL(a.int137,0) + NVL(a.int138,0) +    "
strSQL = strSQL & " NVL(a.int139,0) + NVL(a.int140,0) + NVL(a.int141,0) + NVL(a.int142,0) + NVL(a.int143,0) + NVL(a.int144,0) +    "
strSQL = strSQL & " NVL(a.int145,0) + NVL(a.int146,0) + NVL(a.int147,0) + NVL(a.int148,0) + NVL(a.int149,0) + NVL(a.int150,0) +    "
strSQL = strSQL & " NVL(a.int151,0) + NVL(a.int152,0) + NVL(a.int153,0) + NVL(a.int154,0) + NVL(a.int155,0) + NVL(a.int156,0) +    "
strSQL = strSQL & " NVL(a.int157,0) + NVL(a.int158,0) + NVL(a.int159,0) + NVL(a.int160,0) + NVL(a.int161,0) + NVL(a.int162,0) +    "
strSQL = strSQL & " NVL(a.int163,0) + NVL(a.int164,0) + NVL(a.int165,0) + NVL(a.int166,0) + NVL(a.int167,0) + NVL(a.int168,0) +    "
strSQL = strSQL & " NVL(a.int169,0) + NVL(a.int170,0) + NVL(a.int171,0) + NVL(a.int172,0) + NVL(a.int173,0) + NVL(a.int174,0) +    "
strSQL = strSQL & " NVL(a.int175,0) + NVL(a.int176,0) + NVL(a.int177,0) + NVL(a.int178,0) + NVL(a.int179,0) + NVL(a.int180,0) +    "
strSQL = strSQL & " NVL(a.int181,0) + NVL(a.int182,0) + NVL(a.int183,0) + NVL(a.int184,0) + NVL(a.int185,0) + NVL(a.int186,0) +    "
strSQL = strSQL & " NVL(a.int187,0) + NVL(a.int188,0) + NVL(a.int189,0) + NVL(a.int190,0) + NVL(a.int191,0) + NVL(a.int192,0) +    "
strSQL = strSQL & " NVL(a.int193,0) + NVL(a.int194,0) + NVL(a.int195,0) + NVL(a.int196,0) + NVL(a.int197,0) + NVL(a.int198,0) +    "
strSQL = strSQL & " NVL(a.int199,0) + NVL(a.int200,0) + NVL(a.int201,0) + NVL(a.int202,0) + NVL(a.int203,0) + NVL(a.int204,0) +    "
strSQL = strSQL & " NVL(a.int205,0) + NVL(a.int206,0) + NVL(a.int207,0) + NVL(a.int208,0) + NVL(a.int209,0) + NVL(a.int210,0) +    "
strSQL = strSQL & " NVL(a.int211,0) + NVL(a.int212,0) + NVL(a.int213,0) + NVL(a.int214,0) + NVL(a.int215,0) + NVL(a.int216,0) +    "
strSQL = strSQL & " NVL(a.int217,0) + NVL(a.int218,0) + NVL(a.int219,0) + NVL(a.int220,0) + NVL(a.int221,0) + NVL(a.int222,0) +    "
strSQL = strSQL & " NVL(a.int223,0) + NVL(a.int224,0) + NVL(a.int225,0) + NVL(a.int226,0) + NVL(a.int227,0) + NVL(a.int228,0) +    "
strSQL = strSQL & " NVL(a.int229,0) + NVL(a.int230,0) + NVL(a.int231,0) + NVL(a.int232,0) + NVL(a.int233,0) + NVL(a.int234,0) +    "
strSQL = strSQL & " NVL(a.int235,0) + NVL(a.int236,0) + NVL(a.int237,0) + NVL(a.int238,0) + NVL(a.int239,0) + NVL(a.int240,0) +    "
strSQL = strSQL & " NVL(a.int241,0) + NVL(a.int242,0) + NVL(a.int243,0) + NVL(a.int244,0) + NVL(a.int245,0) + NVL(a.int246,0) +    "
strSQL = strSQL & " NVL(a.int247,0) + NVL(a.int248,0) + NVL(a.int249,0) + NVL(a.int250,0) + NVL(a.int251,0) + NVL(a.int252,0) +    "
strSQL = strSQL & " NVL(a.int253,0) + NVL(a.int254,0) + NVL(a.int255,0) + NVL(a.int256,0) + NVL(a.int257,0) + NVL(a.int258,0) +    "
strSQL = strSQL & " NVL(a.int259,0) + NVL(a.int260,0) + NVL(a.int261,0) + NVL(a.int262,0) + NVL(a.int263,0) + NVL(a.int264,0) +    "
strSQL = strSQL & " NVL(a.int265,0) + NVL(a.int266,0) + NVL(a.int267,0) + NVL(a.int268,0) + NVL(a.int269,0) + NVL(a.int270,0) +    "
strSQL = strSQL & " NVL(a.int271,0) + NVL(a.int272,0) + NVL(a.int273,0) + NVL(a.int274,0) + NVL(a.int275,0) + NVL(a.int276,0) +    "
strSQL = strSQL & " NVL(a.int277,0) + NVL(a.int278,0) + NVL(a.int279,0) + NVL(a.int280,0) + NVL(a.int281,0) + NVL(a.int282,0) +    "
strSQL = strSQL & " NVL(a.int283,0) + NVL(a.int284,0) + NVL(a.int285,0) + NVL(a.int286,0) + NVL(a.int287,0) + NVL(a.int288,0) +    "
strSQL = strSQL & " NVL(a.int289,0) + NVL(a.int290,0) + NVL(a.int291,0) + NVL(a.int292,0) + NVL(a.int293,0) + NVL(a.int294,0) +    "
strSQL = strSQL & " NVL(a.int295,0) + NVL(a.int296,0) + NVL(a.int297,0) + NVL(a.int298,0) + NVL(a.int299,0) + NVL(a.int300,0) AS TOTAL  "
strSQL = strSQL & " , a.name   "
strSQL = strSQL & " FROM billdeterminant a  "
strSQL = strSQL & " WHERE a.messageheaderid in (select MESSAGEHEADERID from date_details)   "
strSQL = strSQL & " AND a.name IN ('BA_MTH_RSRC_TOT_RAAIM_INCV_STLMT@AMOUNT','BA_MTH_RSRC_TOT_RAAIM_NON_AVAIL_STLMT@AMOUNT','BA_MTH_RSRC_BAA_OFFP_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT',   "
strSQL = strSQL & " 'BA_MTH_RSRC_BAA_PEAK_SUPPLY_FRD_UNCERT_ALLOC@AMOUNT','BA_MTH_RSRC_BAA_OFFP_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT','BA_MTH_RSRC_BAA_PEAK_SUPPLY_FRU_UNCERT_ALLOC@AMOUNT')   "
strSQL = strSQL & " AND a.attributevalue2 in ('HATCR1_7_UNIT', 'HATCR2_7_UNIT', 'PIT1_7_UNIT 1', 'PIT1_7_UNIT 2', 'PIT3_7_PL1X3', 'PIT4_7_PL1X2' "
strSQL = strSQL & " , 'PIT5_7_PL1X2', 'PIT5_7_PL3X4', 'BLACK_7_UNIT 1', 'BLACK_7_UNIT 2', 'PIT6_7_UNIT 1', 'PIT6_7_UNIT 2' "
strSQL = strSQL & " , 'PIT7_7_UNIT 1', 'PIT7_7_UNIT 2', 'COLEMN_2_UNIT', 'COWCRK_2_UNIT', 'INSKIP_2_UNIT', 'KILARC_2_UNIT 1' "
strSQL = strSQL & " , 'SOUTH_2_UNIT', 'VOLTA_2_UNIT 1', 'VOLTA_2_UNIT 2', 'HMLTBR_6_UNITS', 'BUTTVL_7_UNIT 1' "
strSQL = strSQL & " , 'CARBOU_7_UNIT 1' , 'CARBOU_7_PL2X3', 'CARBOU_7_PL4X5', 'BUCKCK_7_OAKFLT', 'BELDEN_7_UNIT 1' "
strSQL = strSQL & " , 'RCKCRK_7_UNIT 1', 'RCKCRK_7_UNIT 2', 'BUCKCK_7_PL1X2', 'CRESTA_7_PL1X2', 'POEPH_7_UNIT 1', 'POEPH_7_UNIT 2' "
strSQL = strSQL & " , 'POTTER_6_UNITS', 'TOADTW_6_UNIT', 'DSABLA_7_UNIT', 'CNTRVL_6_UNIT', 'CLRKRD_6_LIMESD', 'NAROW1_2_UNIT' "
strSQL = strSQL & " , 'SPAULD_6_UNIT12', 'SPAULD_6_UNIT 3', 'DEERCR_6_UNIT 1', 'DRUM_7_PL1X2', 'DRUM_7_PL3X4', 'DRUM_7_UNIT 5' "
strSQL = strSQL & " , 'BNNIEN_7_ALTAPH', 'DUTCH1_7_UNIT 1', 'HALSEY_6_UNIT', 'WISE_1_UNIT 1', 'WISE_1_UNIT 2', 'NWCSTL_7_UNIT 1' "
strSQL = strSQL & " , 'PLACVL_1_CHILIB', 'SALTSP_7_UNITS', 'TIGRCK_7_UNITS', 'WESTPT_2_UNIT', 'ELECTR_7_PL1X3', 'SPRGAP_1_UNIT 1' "
strSQL = strSQL & " , 'STANIS_7_UNIT 1', 'PHOENX_1_UNIT', 'MERCFL_6_UNIT', 'HAASPH_7_PL1X2', 'BALCHS_7_UNIT 1', 'BALCHS_7_UNIT 2' "
strSQL = strSQL & " , 'BALCHS_7_UNIT 3', 'KINGRV_7_UNIT 1', 'CRNEVL_6_CRNVA', 'WISHON_6_UNITS', 'CRNEVL_6_SJQN 2' "
strSQL = strSQL & " , 'CRNEVL_6_SJQN 3', 'KERKH1_7_UNIT 1', 'KERKH1_7_UNIT 3', 'KERKH2_7_UNIT 1', 'SPRGVL_2_TULE' "
strSQL = strSQL & " , 'KRNCNY_6_UNIT', 'HELMPG_7_UNIT 1', 'HELMPG_7_UNIT 1', 'HELMPG_7_UNIT 2', 'HELMPG_7_UNIT 2' "
strSQL = strSQL & " , 'HELMPG_7_UNIT 3', 'HELMPG_7_UNIT 3', 'DIABLO_7_UNIT 1', 'DIABLO_7_UNIT 2', 'HUMBPP_6_UNITS' "
strSQL = strSQL & " , 'HUMBPP_1_UNITS3', 'COLUSA_2_PL1X3', 'GATWAY_2_PL1X3', 'CANTUA_1_SOLAR', 'SCHNDR_1_FIVPTS' "
strSQL = strSQL & " , 'GATES_2_SOLAR', 'GUERNS_6_SOLAR', 'GIFFEN_6_SOLAR', 'HURON_6_SOLAR', 'STROUD_6_SOLAR' "
strSQL = strSQL & " , 'VACADX_1_SOLAR', 'GATES_2_WSOLAR', 'SCHNDR_1_WSTSDE', 'CASTVL_2_FCELL', 'DALYCT_1_FCELL' "
strSQL = strSQL & " , 'VACADX_1_NAS', 'SWIFT_1_NAS'))) "
strSQL = strSQL & " GROUP BY RESOURCE_NAME, RESOURCE_TYPE, name)  "
strSQL = strSQL & " GROUP BY AREA, RESOURCE_NAME, RESOURCE_TYPE, PRIORITY  "
strSQL = strSQL & " ORDER BY PRIORITY  "


'Set Object to Run SQL Statement'
Set OraDynaset = objdatabase.DBCreateDynaset(strSQL, 0)

'Adjust Placement(for both x and y, i.e. (x+1)'
If OraDynaset.RecordCount > 0 Then
    OraDynaset.MoveFirst
    For X = 0 To OraDynaset.Fields.Count - 1
        Cells(1, X + 1) = OraDynaset.Fields(X).Name
        Cells(1, X + 1).Font.Bold = True '
    Next
    
    For y = 0 To OraDynaset.RecordCount - 1
        For X = 0 To OraDynaset.Fields.Count - 1
            Cells(y + 103, X + 1) = OraDynaset.Fields(X).Value
        Next
        OraDynaset.MoveNext
    Next
End If
'END SETTLEMENTS RUN'


'Refresh ALL the Pivot Tables in the workbook
For Each Worksheet In ActiveWorkbook.Worksheets
    For Each PivotTable In Worksheet.PivotTables
        PivotTable.RefreshTable
    Next PivotTable
Next Worksheet

'Copy and Paste Data on Report'
Sheets("Energy Pivot").Range("J3:AC114").Copy
Sheets("Energy Settlements").Range("H6").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
Sheets("Energy Pivot").Range("C3:F114").Copy
Sheets("Energy Settlements").Range("D6").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False

' Report Title
If input_StartDate = input_EndDate Then
    Worksheets("Energy Settlements").Range("A1") = "Utility Owned Generation Settlements Report: " & Format(input_StartDate, "mmmm-yyyy")
    relativePath = ThisWorkbook.Path & "\UOG Settlements Report " & Format(input_StartDate, "mmmm-yyyy")
Else
    Worksheets("Energy Settlements").Range("A1") = "Utility Owned Generation Settlements Report: " & Format(input_StartDate, "mmmm-yyyy") & " to " & Format(input_EndDate, "mmmm-yyyy")
    relativePath = ThisWorkbook.Path & "\UOG Settlements Report " & Format(input_StartDate, "mmmm-yyyy") & " to " & Format(input_EndDate, "mmmm-yyyy")
End If


' Copy data to a new workbook
Dim ws As Worksheet
Dim wb As Workbook
Set wb = Application.Workbooks.Add

For Each ws In ThisWorkbook.Worksheets 'SetVersions
    If ws.Name <> "Energy Pivot" And ws.Name <> "Settlements Data" And ws.Name <> "Motoring Data" Then
        ws.Copy Before:=wb.Sheets("Sheet1")
    End If
Next ws

'New Workbook formatting
wb.Sheets("Sheet1").Delete
wb.Sheets("Sheet2").Delete
wb.Sheets("Sheet3").Delete

wb.Sheets("Energy Settlements").Select
wb.Sheets("Energy Settlements").Range("A1").Select

' new file name and saving
wb.SaveAs relativePath & ".xlsx"
wb.Close SaveChanges:=True


'Screen updating and alerts On
Application.DisplayAlerts = True
Application.ScreenUpdating = True


End Sub
Private Sub cmdCancel_Click()
    Unload Me
End Sub

